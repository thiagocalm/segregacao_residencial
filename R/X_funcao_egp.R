
# funcao --------------------------------------------------------------------

func_tratamento_classes_egp <- function(
    dados = censo,
    dados_cnae = tabela_cnae,
    var_cnae_censo = "v4462",
    var_cnae_compatibilizacao = "CNAE_Dom",
    compatibilizacao_cnae = TRUE,
    construir_var_pea = TRUE,
    var_trabalhando = "v0439",
    var_afastado = "v0440",
    var_aprendiz = "v0441",
    var_trabalho_consumo = "v0443",
    var_buscou_emprego = "v0455",
    var_posicao_ocupacao = "v0447",
    var_codigo_ocupacao = "v4452"){

  # variaveis que serao utilizadas
  vars <- c(var_trabalhando,var_afastado,var_aprendiz,var_trabalho_consumo,var_buscou_emprego,
            var_posicao_ocupacao, var_codigo_ocupacao)

  # criacao da base menor de trabalho
  if(compatibilizacao_cnae == TRUE){
    if(var_cnae_compatibilizacao == "CNAE_Dom"){
      censo_processing <- dados |>
        select(id_dom, id_pes, all_of(var_cnae_censo), var_trabalhando = all_of(var_trabalhando),
               var_afastado = all_of(var_afastado), var_aprendiz = all_of(var_aprendiz),
               var_trabalho_consumo = all_of(var_trabalho_consumo),
               var_buscou_emprego = all_of(var_buscou_emprego),
               var_posicao_ocupacao = all_of(var_posicao_ocupacao),
               var_codigo_ocupacao = all_of(var_codigo_ocupacao)) |>
        left_join(
          dados_cnae[,var_cnae_compatibilizacao] |> distinct(),
          by = c("v4462" = "CNAE_Dom"),
          keep = TRUE)
    } else{
      censo_processing <- dados |>
        select(id_dom, id_pes, all_of(var_cnae_censo), var_trabalhando = all_of(var_trabalhando),
               var_afastado = all_of(var_afastado), var_aprendiz = all_of(var_aprendiz),
               var_trabalho_consumo = all_of(var_trabalho_consumo),
               var_buscou_emprego = all_of(var_buscou_emprego),
               var_posicao_ocupacao = all_of(var_posicao_ocupacao),
               var_codigo_ocupacao = all_of(var_codigo_ocupacao)) |>
        left_join(
          dados_cnae[,var_cnae_compatibilizacao] |> distinct(),
          by = c("v6471" = "CNAE_Dom2"),
          keep = TRUE)
    }
  } else{
    censo_processing <- censo |>
      select(id_dom, id_pes, CNAE_Dom = var_cnae_censo, all_of(vars))
  }

  # criando variavesi de PEA, PO e PosicaoOcupacao
  if(var_cnae_compatibilizacao == "CNAE_Dom"){
    censo_processing <- censo_processing |>
      mutate(
        PEA = case_when(
          var_trabalhando == 1 ~ 1,
          var_trabalhando != 1 & var_afastado == 1 ~ 1,
          var_trabalhando != 1 & var_aprendiz == 1 ~ 1,
          var_trabalhando != 1 & var_trabalho_consumo == 1 ~ 1,
          var_trabalhando != 1 & var_buscou_emprego == 1 ~ 1,
          TRUE ~ 0),
        PO = case_when(
          var_trabalhando == 1 ~ 1,
          var_trabalhando != 1 & var_afastado == 1 ~ 1,
          var_trabalhando != 1 & var_aprendiz == 1 ~ 1,
          var_trabalhando != 1 & var_trabalho_consumo == 1 ~ 1,
          var_trabalhando != 1 & var_buscou_emprego == 1 &
            var_afastado != 1 &
            var_aprendiz != 1 &
            var_trabalho_consumo != 1 ~ 0,
          TRUE ~ 0),
        PosicaoOcupacao = case_when(
          var_posicao_ocupacao %in% c(7,8,9) ~ 0, #trabalhador familiar nao remunerado
          var_posicao_ocupacao %in% c(1,2,3,4) ~ 1, #empregado
          var_posicao_ocupacao == 5 ~ 2, #empregador
          var_posicao_ocupacao == 6 ~ 3) #conta propria
      ) |>
      filter(PO == 1)
  } else{
    censo_processing <- censo_processing |>
      mutate(
        PEA = case_when(
          var_trabalhando == 1 ~ 1,
          var_trabalhando != 1 & var_afastado == 1 ~ 1,
          var_trabalhando != 1 & var_aprendiz == 1 ~ 1,
          var_trabalhando != 1 & var_trabalho_consumo == 1 ~ 1,
          var_trabalhando != 1 & var_buscou_emprego == 1 ~ 1,
          TRUE ~ 0),
        PO = case_when(
          var_trabalhando == 1 ~ 1,
          var_trabalhando != 1 & var_afastado == 1 ~ 1,
          var_trabalhando != 1 & var_aprendiz == 1 ~ 1,
          var_trabalhando != 1 & var_trabalho_consumo == 1 ~ 1,
          var_trabalhando != 1 & var_buscou_emprego == 1 &
            var_afastado != 1 &
            var_aprendiz != 1 &
            var_trabalho_consumo != 1 ~ 0,
          TRUE ~ 0),
        PosicaoOcupacao = case_when(
          var_posicao_ocupacao %in% c(7,8,9) ~ 0, #trabalhador familiar nao remunerado
          var_posicao_ocupacao %in% c(1,2,3,4) ~ 1, #empregado
          var_posicao_ocupacao == 6 ~ 2, #empregador
          var_posicao_ocupacao == 5 ~ 3) #conta propria
      ) |>
      filter(PO == 1)
  }

  # Processamento das variaveis ISIC, ISCO, EGP
  if(var_cnae_compatibilizacao == "CNAE_Dom"){
    censo_processing <- censo_processing |>
      mutate(
        ISIC = case_when(
          CNAE_Dom == 0 ~ 999, #NA
          CNAE_Dom >= 1101 & CNAE_Dom <= 3002 ~ 10,
          CNAE_Dom >= 5000 & CNAE_Dom <= 9000 ~ 20,
          CNAE_Dom >= 10010 & CNAE_Dom <= 33002 ~ 30,
          CNAE_Dom >= 35010 & CNAE_Dom <= 39000 ~ 40,
          CNAE_Dom >= 41000 & CNAE_Dom <= 43000 ~ 50,
          CNAE_Dom == 45020 ~ 114,
          CNAE_Dom >= 45010 & CNAE_Dom <= 48100 ~ 60,
          CNAE_Dom >= 49010 & CNAE_Dom <= 53002 ~ 80,
          CNAE_Dom >= 55000 & CNAE_Dom <= 56999 ~ 70,
          CNAE_Dom >= 58000 & CNAE_Dom <= 60002 ~ 114,
          CNAE_Dom == 61000 ~ 80,
          CNAE_Dom >= 62000 & CNAE_Dom <= 63000 ~ 111,
          CNAE_Dom >= 64000 & CNAE_Dom <= 66002 ~ 90,
          CNAE_Dom >= 68000 & CNAE_Dom <= 74000 ~ 111,
          CNAE_Dom == 75000~ 113,
          CNAE_Dom == 77010 | CNAE_Dom == 79000 ~ 114,
          CNAE_Dom >= 77020 & CNAE_Dom <= 82009 ~ 111,
          CNAE_Dom >= 84011 & CNAE_Dom <= 84020 ~ 100,
          CNAE_Dom >= 85011 & CNAE_Dom <= 85999 ~ 112,
          CNAE_Dom >= 86001 & CNAE_Dom <= 88000 ~ 113,
          CNAE_Dom == 99000 | CNAE_Dom >= 90000 & CNAE_Dom <= 96090 ~ 114,
          CNAE_Dom == 97000 ~ 120,
          CNAE_Dom == 99999 ~ 999 #NA
        )
      )
  } else{
    censo_processing <- censo_processing |>
      mutate(
        ISIC = case_when(
          CNAE_Dom2 == 0 ~ 999, #NA
          CNAE_Dom2 >= 1101 & CNAE_Dom2 <= 3002 ~ 10,
          CNAE_Dom2 >= 5000 & CNAE_Dom2 <= 9000 ~ 20,
          CNAE_Dom2 >= 10010 & CNAE_Dom2 <= 33002 ~ 30,
          CNAE_Dom2 >= 35010 & CNAE_Dom2 <= 39000 ~ 40,
          CNAE_Dom2 >= 41000 & CNAE_Dom2 <= 43000 ~ 50,
          CNAE_Dom2 == 45020 ~ 114,
          CNAE_Dom2 >= 45010 & CNAE_Dom2 <= 48100 ~ 60,
          CNAE_Dom2 >= 49010 & CNAE_Dom2 <= 53002 ~ 80,
          CNAE_Dom2 >= 55000 & CNAE_Dom2 <= 56999 ~ 70,
          CNAE_Dom2 >= 58000 & CNAE_Dom2 <= 60002 ~ 114,
          CNAE_Dom2 == 61000 ~ 80,
          CNAE_Dom2 >= 62000 & CNAE_Dom2 <= 63000 ~ 111,
          CNAE_Dom2 >= 64000 & CNAE_Dom2 <= 66002 ~ 90,
          CNAE_Dom2 >= 68000 & CNAE_Dom2 <= 74000 ~ 111,
          CNAE_Dom2 == 75000~ 113,
          CNAE_Dom2 == 77010 | CNAE_Dom2 == 79000 ~ 114,
          CNAE_Dom2 >= 77020 & CNAE_Dom2 <= 82009 ~ 111,
          CNAE_Dom2 >= 84011 & CNAE_Dom2 <= 84020 ~ 100,
          CNAE_Dom2 >= 85011 & CNAE_Dom2 <= 85999 ~ 112,
          CNAE_Dom2 >= 86001 & CNAE_Dom2 <= 88000 ~ 113,
          CNAE_Dom2 == 99000 | CNAE_Dom2 >= 90000 & CNAE_Dom2 <= 96090 ~ 114,
          CNAE_Dom2 == 97000 ~ 120,
          CNAE_Dom2 == 99999 ~ 999 #NA
        )
      )
  }

  censo_processing <- censo_processing |>
    mutate(
      ISCO = case_when(
        var_codigo_ocupacao >= 110 & var_codigo_ocupacao <= 999 | var_codigo_ocupacao == 5411 ~ 110,
        var_codigo_ocupacao ==1111~1110,
        var_codigo_ocupacao ==1113~1110,
        var_codigo_ocupacao ==1112~1120,
        var_codigo_ocupacao ==1114~1143,
        var_codigo_ocupacao ==1120~1210,
        var_codigo_ocupacao ==1311~1221,
        var_codigo_ocupacao ==1312~1221,
        var_codigo_ocupacao ==1321~1222,
        var_codigo_ocupacao ==1322~1222,
        var_codigo_ocupacao ==1323~1223,
        var_codigo_ocupacao ==1420~1224,
        var_codigo_ocupacao ==1411~1225,
        var_codigo_ocupacao ==1412~1225,
        var_codigo_ocupacao ==1324~1226,
        var_codigo_ocupacao ==1330~1226,
        var_codigo_ocupacao ==1219~1229,
        var_codigo_ocupacao ==1346~1227,
        var_codigo_ocupacao ==1213~1229,
        var_codigo_ocupacao ==1341~1229,
        var_codigo_ocupacao ==1342~1229,
        var_codigo_ocupacao ==1343~1229,
        var_codigo_ocupacao ==1344~1229,
        var_codigo_ocupacao ==1345~1229,
        var_codigo_ocupacao ==1349~1229,
        var_codigo_ocupacao ==1431~1229,
        var_codigo_ocupacao ==1439~1229,
        var_codigo_ocupacao ==1211~1231,
        var_codigo_ocupacao ==1212~1232,
        var_codigo_ocupacao ==1221~1233,
        var_codigo_ocupacao ==1222~1234,
        var_codigo_ocupacao ==1223~1237,
        var_codigo_ocupacao ==2111~2111,
        var_codigo_ocupacao ==2112~2112,
        var_codigo_ocupacao ==2113~2113,
        var_codigo_ocupacao ==2114~2114,
        var_codigo_ocupacao ==2120~2121,
        var_codigo_ocupacao ==2511~2131,
        var_codigo_ocupacao ==2512~2131,
        var_codigo_ocupacao ==2513~2131,
        var_codigo_ocupacao ==2514~2131,
        var_codigo_ocupacao ==2519~2131,
        var_codigo_ocupacao ==2521~2131,
        var_codigo_ocupacao ==2522~2131,
        var_codigo_ocupacao ==2523~2131,
        var_codigo_ocupacao ==2529~2131,
        var_codigo_ocupacao ==2161~2141,
        var_codigo_ocupacao ==2162~2141,
        var_codigo_ocupacao ==2164~2141,
        var_codigo_ocupacao ==2142~2142,
        var_codigo_ocupacao ==2151~2143,
        var_codigo_ocupacao ==2152~2144,
        var_codigo_ocupacao ==2153~2144,
        var_codigo_ocupacao ==2144~2145,
        var_codigo_ocupacao ==2145~2146,
        var_codigo_ocupacao ==2146~2147,
        var_codigo_ocupacao ==2165~2148,
        var_codigo_ocupacao ==2141~2149,
        var_codigo_ocupacao ==2143~2149,
        var_codigo_ocupacao ==2149~2149,
        var_codigo_ocupacao ==2131~2211,
        var_codigo_ocupacao ==2133~2211,
        var_codigo_ocupacao ==2132~2213,
        var_codigo_ocupacao ==2211~2221,
        var_codigo_ocupacao ==2212~2221,
        var_codigo_ocupacao ==2261~2222,
        var_codigo_ocupacao ==2250~2223,
        var_codigo_ocupacao ==2262~2224,
        var_codigo_ocupacao ==2263~2229,
        var_codigo_ocupacao ==2266~2229,
        var_codigo_ocupacao ==2269~2229,
        var_codigo_ocupacao ==2221~2230,
        var_codigo_ocupacao ==2222~2230,
        var_codigo_ocupacao ==2310~2310,
        var_codigo_ocupacao ==2330~2320,
        var_codigo_ocupacao ==2341~2331,
        var_codigo_ocupacao ==2342~2332,
        var_codigo_ocupacao ==2351~2351,
        var_codigo_ocupacao ==2320~2359,
        var_codigo_ocupacao ==2352~2359,
        var_codigo_ocupacao ==2353~2359,
        var_codigo_ocupacao ==2354~2359,
        var_codigo_ocupacao ==2355~2359,
        var_codigo_ocupacao ==2356~2359,
        var_codigo_ocupacao ==2359~2359,
        var_codigo_ocupacao ==3423~2359,
        var_codigo_ocupacao ==5165~2359,
        var_codigo_ocupacao ==2411~2411,
        var_codigo_ocupacao ==2412~2411,
        var_codigo_ocupacao ==2423~2412,
        var_codigo_ocupacao ==2424~2412,
        var_codigo_ocupacao ==2413~2419,
        var_codigo_ocupacao ==2421~2419,
        var_codigo_ocupacao ==2422~2419,
        var_codigo_ocupacao ==2431~2419,
        var_codigo_ocupacao ==2432~2419,
        var_codigo_ocupacao ==2611~2421,
        var_codigo_ocupacao ==2619~2421,
        var_codigo_ocupacao ==2612~2422,
        var_codigo_ocupacao ==2621~2431,
        var_codigo_ocupacao ==2622~2432,
        var_codigo_ocupacao ==2631~2441,
        var_codigo_ocupacao ==2632~2442,
        var_codigo_ocupacao ==2633~2443,
        var_codigo_ocupacao ==2643~2444,
        var_codigo_ocupacao ==2634~2445,
        var_codigo_ocupacao ==2635~2446,
        var_codigo_ocupacao ==2641~2451,
        var_codigo_ocupacao ==2642~2451,
        var_codigo_ocupacao ==2651~2452,
        var_codigo_ocupacao ==2652~2453,
        var_codigo_ocupacao ==2653~2454,
        var_codigo_ocupacao ==2654~2455,
        var_codigo_ocupacao ==2655~2455,
        var_codigo_ocupacao ==2659~2455,
        var_codigo_ocupacao ==2636~2460,
        var_codigo_ocupacao ==3111~3111,
        var_codigo_ocupacao ==3139~3111,
        var_codigo_ocupacao ==3112~3112,
        var_codigo_ocupacao ==3113~3113,
        var_codigo_ocupacao ==3114~3114,
        var_codigo_ocupacao ==3522~3114,
        var_codigo_ocupacao ==3115~3115,
        var_codigo_ocupacao ==3116~3116,
        var_codigo_ocupacao ==3117~3117,
        var_codigo_ocupacao ==3118~3118,
        var_codigo_ocupacao ==3119~3119,
        var_codigo_ocupacao ==3511~3121,
        var_codigo_ocupacao ==3512~3121,
        var_codigo_ocupacao ==3513~3121,
        var_codigo_ocupacao ==3514~3121,
        var_codigo_ocupacao ==3431~3131,
        var_codigo_ocupacao ==3521~3131,
        var_codigo_ocupacao ==3211~3133,
        var_codigo_ocupacao ==3151~3141,
        var_codigo_ocupacao ==3152~3142,
        var_codigo_ocupacao ==3153~3143,
        var_codigo_ocupacao ==3154~3144,
        var_codigo_ocupacao ==3155~3145,
        var_codigo_ocupacao ==3257~3152,
        var_codigo_ocupacao ==7543~3152,
        var_codigo_ocupacao ==3141~3211,
        var_codigo_ocupacao ==3212~3211,
        var_codigo_ocupacao ==3142~3212,
        var_codigo_ocupacao ==3143~3212,
        var_codigo_ocupacao ==2240~3221,
        var_codigo_ocupacao ==3256~3221,
        var_codigo_ocupacao ==3252~3222,
        var_codigo_ocupacao ==2265~3223,
        var_codigo_ocupacao ==2267~3224,
        var_codigo_ocupacao ==3254~3224,
        var_codigo_ocupacao ==3214~3225,
        var_codigo_ocupacao ==3251~3225,
        var_codigo_ocupacao ==2264~3226,
        var_codigo_ocupacao ==3255~3226,
        var_codigo_ocupacao ==3240~3227,
        var_codigo_ocupacao ==3213~3228,
        var_codigo_ocupacao ==3259~3229,
        var_codigo_ocupacao ==3221~3231,
        var_codigo_ocupacao ==3222~3232,
        var_codigo_ocupacao ==2230~3241,
        var_codigo_ocupacao ==3230~3241,
        var_codigo_ocupacao ==3413~3242,
        var_codigo_ocupacao ==3311~3411,
        var_codigo_ocupacao ==3312~3411,
        var_codigo_ocupacao ==3321~3412,
        var_codigo_ocupacao ==3334~3413,
        var_codigo_ocupacao ==4221~3414,
        var_codigo_ocupacao ==2433~3415,
        var_codigo_ocupacao ==2434~3415,
        var_codigo_ocupacao ==3322~3415,
        var_codigo_ocupacao ==3339~3415,
        var_codigo_ocupacao ==3323~3416,
        var_codigo_ocupacao ==3315~3417,
        var_codigo_ocupacao ==3324~3421,
        var_codigo_ocupacao ==3331~3422,
        var_codigo_ocupacao ==3351~3422,
        var_codigo_ocupacao ==3333~3423,
        var_codigo_ocupacao ==3341~3431,
        var_codigo_ocupacao ==3342~3431,
        var_codigo_ocupacao ==3343~3431,
        var_codigo_ocupacao ==3344~3431,
        var_codigo_ocupacao ==3411~3432,
        var_codigo_ocupacao ==3313~3433,
        var_codigo_ocupacao ==3314~3434,
        var_codigo_ocupacao ==3332~3439,
        var_codigo_ocupacao ==3433~3439,
        var_codigo_ocupacao ==3435~3439,
        var_codigo_ocupacao ==3352~3442,
        var_codigo_ocupacao ==3353~3443,
        var_codigo_ocupacao ==3354~3444,
        var_codigo_ocupacao ==3359~3444,
        var_codigo_ocupacao ==3355~3450,
        var_codigo_ocupacao ==3412~3460,
        var_codigo_ocupacao ==2163~3471,
        var_codigo_ocupacao ==2166~3471,
        var_codigo_ocupacao ==3432~3471,
        var_codigo_ocupacao ==2656~3472,
        var_codigo_ocupacao ==3421~3475,
        var_codigo_ocupacao ==3422~3475,
        var_codigo_ocupacao ==4131~4111,
        var_codigo_ocupacao ==4132~4113,
        var_codigo_ocupacao ==4120~4115,
        var_codigo_ocupacao ==4211~4121,
        var_codigo_ocupacao ==4311~4121,
        var_codigo_ocupacao ==4313~4121,
        var_codigo_ocupacao ==4227~4122,
        var_codigo_ocupacao ==4312~4122,
        var_codigo_ocupacao ==4321~4131,
        var_codigo_ocupacao ==4322~4132,
        var_codigo_ocupacao ==4323~4133,
        var_codigo_ocupacao ==4411~4141,
        var_codigo_ocupacao ==4415~4141,
        var_codigo_ocupacao ==4412~4142,
        var_codigo_ocupacao ==4413~4143,
        var_codigo_ocupacao ==4414~4144,
        var_codigo_ocupacao ==4110~4190,
        var_codigo_ocupacao ==4416~4190,
        var_codigo_ocupacao ==4419~4190,
        var_codigo_ocupacao ==5230~4211,
        var_codigo_ocupacao ==4212~4212,
        var_codigo_ocupacao ==4213~4214,
        var_codigo_ocupacao ==4214~4215,
        var_codigo_ocupacao ==4224~4222,
        var_codigo_ocupacao ==4225~4222,
        var_codigo_ocupacao ==4226~4222,
        var_codigo_ocupacao ==4229~4222,
        var_codigo_ocupacao ==4222~4223,
        var_codigo_ocupacao ==4223~4223,
        var_codigo_ocupacao ==5111~5111,
        var_codigo_ocupacao ==5112~5112,
        var_codigo_ocupacao ==8331~5112,
        var_codigo_ocupacao ==5113~5113,
        var_codigo_ocupacao ==5151~5121,
        var_codigo_ocupacao ==5152~5121,
        var_codigo_ocupacao ==3434~5122,
        var_codigo_ocupacao ==5120~5122,
        var_codigo_ocupacao ==9411~5122,
        var_codigo_ocupacao ==9412~5122,
        var_codigo_ocupacao ==5131~5123,
        var_codigo_ocupacao ==5132~5123,
        var_codigo_ocupacao ==5311~5131,
        var_codigo_ocupacao ==5312~5131,
        var_codigo_ocupacao ==3258~5132,
        var_codigo_ocupacao ==5321~5132,
        var_codigo_ocupacao ==5329~5132,
        var_codigo_ocupacao ==5322~5133,
        var_codigo_ocupacao ==3253~5139,
        var_codigo_ocupacao ==5164~5139,
        var_codigo_ocupacao ==5141~5141,
        var_codigo_ocupacao ==5142~5141,
        var_codigo_ocupacao ==5162~5142,
        var_codigo_ocupacao ==5163~5143,
        var_codigo_ocupacao ==5169~5149,
        var_codigo_ocupacao ==5161~5151,
        var_codigo_ocupacao ==5412~5162,
        var_codigo_ocupacao ==5413~5163,
        var_codigo_ocupacao ==5414~9152,
        var_codigo_ocupacao ==5419~5169,
        var_codigo_ocupacao ==5241~5210,
        var_codigo_ocupacao ==5221~5220,
        var_codigo_ocupacao ==5222~5220,
        var_codigo_ocupacao ==5223~5220,
        var_codigo_ocupacao ==5242~5220,
        var_codigo_ocupacao ==5245~5220,
        var_codigo_ocupacao ==5246~5220,
        var_codigo_ocupacao ==5249~5220,
        var_codigo_ocupacao ==5211~5230,
        var_codigo_ocupacao ==6111~6111,
        var_codigo_ocupacao ==6114~6111,
        var_codigo_ocupacao ==6112~6113,
        var_codigo_ocupacao ==9214~9211,
        var_codigo_ocupacao ==6121~6121,
        var_codigo_ocupacao ==6122~6122,
        var_codigo_ocupacao ==6123~6123,
        var_codigo_ocupacao ==6129~6129,
        var_codigo_ocupacao ==6130~6141,
        var_codigo_ocupacao ==6210~6141,
        var_codigo_ocupacao ==9215~9212,
        var_codigo_ocupacao ==6221~6151,
        var_codigo_ocupacao ==6225~6152,
        var_codigo_ocupacao ==6224~6154,
        var_codigo_ocupacao ==9216~9212,
        var_codigo_ocupacao ==3121~7111,
        var_codigo_ocupacao ==8111~7111,
        var_codigo_ocupacao ==7542~7112,
        var_codigo_ocupacao ==7113~7113,
        var_codigo_ocupacao ==7111~7122,
        var_codigo_ocupacao ==7112~7122,
        var_codigo_ocupacao ==9312~7122,
        var_codigo_ocupacao ==9313~7122,
        var_codigo_ocupacao ==7114~7123,
        var_codigo_ocupacao ==7115~7124,
        var_codigo_ocupacao ==3123~7129,
        var_codigo_ocupacao ==7119~7129,
        var_codigo_ocupacao ==7121~7131,
        var_codigo_ocupacao ==7122~7132,
        var_codigo_ocupacao ==7123~7133,
        var_codigo_ocupacao ==7124~7134,
        var_codigo_ocupacao ==7125~7135,
        var_codigo_ocupacao ==7126~7136,
        var_codigo_ocupacao ==7411~7137,
        var_codigo_ocupacao ==7131~7141,
        var_codigo_ocupacao ==7132~7142,
        var_codigo_ocupacao ==7133~7143,
        var_codigo_ocupacao ==7544~7143,
        var_codigo_ocupacao ==7211~7211,
        var_codigo_ocupacao ==7212~7212,
        var_codigo_ocupacao ==7213~7213,
        var_codigo_ocupacao ==7214~7214,
        var_codigo_ocupacao ==7215~7215,
        var_codigo_ocupacao ==7541~7216,
        var_codigo_ocupacao ==7221~7221,
        var_codigo_ocupacao ==7222~7222,
        var_codigo_ocupacao ==7223~7223,
        var_codigo_ocupacao ==7224~7224,
        var_codigo_ocupacao ==7231~7231,
        var_codigo_ocupacao ==7234~7231,
        var_codigo_ocupacao ==7232~7232,
        var_codigo_ocupacao ==7127~7233,
        var_codigo_ocupacao ==7233~7233,
        var_codigo_ocupacao ==7412~7241,
        var_codigo_ocupacao ==7421~7242,
        var_codigo_ocupacao ==7422~7244,
        var_codigo_ocupacao ==7413~7245,
        var_codigo_ocupacao ==7311~7311,
        var_codigo_ocupacao ==7312~7312,
        var_codigo_ocupacao ==7313~7313,
        var_codigo_ocupacao ==7314~7321,
        var_codigo_ocupacao ==7315~7322,
        var_codigo_ocupacao ==7316~7324,
        var_codigo_ocupacao ==7317~7331,
        var_codigo_ocupacao ==7319~7331,
        var_codigo_ocupacao ==7549~7331,
        var_codigo_ocupacao ==7318~7332,
        var_codigo_ocupacao ==7321~7341,
        var_codigo_ocupacao ==8132~7344,
        var_codigo_ocupacao ==7323~7345,
        var_codigo_ocupacao ==7511~7411,
        var_codigo_ocupacao ==7512~7412,
        var_codigo_ocupacao ==7513~7413,
        var_codigo_ocupacao ==7514~7414,
        var_codigo_ocupacao ==7515~7415,
        var_codigo_ocupacao ==7516~7416,
        var_codigo_ocupacao ==7521~7421,
        var_codigo_ocupacao ==7522~7422,
        var_codigo_ocupacao ==7523~7423,
        var_codigo_ocupacao ==8152~8262,
        var_codigo_ocupacao ==7531~7433,
        var_codigo_ocupacao ==7532~7435,
        var_codigo_ocupacao ==7533~7436,
        var_codigo_ocupacao ==7534~7437,
        var_codigo_ocupacao ==7535~7441,
        var_codigo_ocupacao ==7536~7442,
        var_codigo_ocupacao ==8112~8112,
        var_codigo_ocupacao ==8113~8113,
        var_codigo_ocupacao ==3135~8121,
        var_codigo_ocupacao ==8121~8121,
        var_codigo_ocupacao ==8181~8131,
        var_codigo_ocupacao ==8172~8141,
        var_codigo_ocupacao ==8171~8142,
        var_codigo_ocupacao ==8131~8151,
        var_codigo_ocupacao ==3133~8152,
        var_codigo_ocupacao ==3134~8155,
        var_codigo_ocupacao ==3131~8161,
        var_codigo_ocupacao ==8182~8162,
        var_codigo_ocupacao ==3132~8163,
        var_codigo_ocupacao ==3122~8171,
        var_codigo_ocupacao ==8114~8212,
        var_codigo_ocupacao ==8122~8223,
        var_codigo_ocupacao ==8141~8231,
        var_codigo_ocupacao ==8142~8232,
        var_codigo_ocupacao ==7322~8251,
        var_codigo_ocupacao ==8143~8253,
        var_codigo_ocupacao ==8151~8261,
        var_codigo_ocupacao ==8153~8263,
        var_codigo_ocupacao ==8154~8264,
        var_codigo_ocupacao ==8157~8264,
        var_codigo_ocupacao ==8155~8265,
        var_codigo_ocupacao ==8156~8266,
        var_codigo_ocupacao ==8159~8269,
        var_codigo_ocupacao ==8160~8271,
        var_codigo_ocupacao ==8211~8281,
        var_codigo_ocupacao ==8212~8282,
        var_codigo_ocupacao ==8189~8290,
        var_codigo_ocupacao ==8219~8290,
        var_codigo_ocupacao ==8311~8311,
        var_codigo_ocupacao ==8312~8312,
        var_codigo_ocupacao ==8321~8321,
        var_codigo_ocupacao ==8322~8322,
        var_codigo_ocupacao ==8332~8324,
        var_codigo_ocupacao ==8341~8331,
        var_codigo_ocupacao ==8342~8332,
        var_codigo_ocupacao ==8343~8333,
        var_codigo_ocupacao ==8344~8334,
        var_codigo_ocupacao ==8350~8340,
        var_codigo_ocupacao ==5212~9111,
        var_codigo_ocupacao ==9520~9112,
        var_codigo_ocupacao ==5243~9113,
        var_codigo_ocupacao ==5244~9113,
        var_codigo_ocupacao ==9510~9120,
        var_codigo_ocupacao ==9111~9131,
        var_codigo_ocupacao ==9112~9132,
        var_codigo_ocupacao ==9129~9132,
        var_codigo_ocupacao ==9121~9133,
        var_codigo_ocupacao ==9122~9142,
        var_codigo_ocupacao ==9123~9142,
        var_codigo_ocupacao ==9621~9151,
        var_codigo_ocupacao ==5153~9141,
        var_codigo_ocupacao ==9623~9153,
        var_codigo_ocupacao ==9611~9161,
        var_codigo_ocupacao ==9612~9161,
        var_codigo_ocupacao ==9613~9162,
        var_codigo_ocupacao ==9622~9162,
        var_codigo_ocupacao ==9624~9162,
        var_codigo_ocupacao ==9211~9211,
        var_codigo_ocupacao ==9212~9211,
        var_codigo_ocupacao ==9213~9211,
        var_codigo_ocupacao ==9311~9311,
        var_codigo_ocupacao ==9329~9321,
        var_codigo_ocupacao ==8183~9322,
        var_codigo_ocupacao ==9321~9322,
        var_codigo_ocupacao ==9331~9331,
        var_codigo_ocupacao ==9332~9332,
        var_codigo_ocupacao ==9333~9333,
        var_codigo_ocupacao ==9334~9333,
        var_codigo_ocupacao ==9629~999,
        var_codigo_ocupacao ==9999~999,
        var_codigo_ocupacao ==9998~999,
        var_codigo_ocupacao ==9988~999,
        var_codigo_ocupacao == 0 | var_codigo_ocupacao == 5168 ~ 999
      )
    ) |>
    mutate(ISCO = case_when(
      ISCO == 6122 & PosicaoOcupacao == 2 ~ 1311,
      ISCO %in% c(1143,1210,1221:1227,1229,1231:1234,1237) & ISIC == 100 &
        PosicaoOcupacao == 3 ~ 1120,
      ISCO %in% c(9211, 6113) & ISIC %in% c(114, 120) ~ 9141,
      PosicaoOcupacao == 1 & ISCO %in% c(6111, 6113, 6123, 6129) ~ 9211,
      PosicaoOcupacao == 1 & ISCO %in% c(6121, 6122) ~ 9211,
      PosicaoOcupacao == 1 & ISCO %in% c( 6141, 6142) ~ 9212,
      PosicaoOcupacao == 1 & ISCO %in% c(6151:6154) ~ 9213,
      PosicaoOcupacao == 1 & ISCO %in% c(6111, 6113, 6123, 6129) ~ 1311,
      TRUE ~ ISCO)) |>
    mutate(
      EGP11 = case_when(
        ISCO == 1110 ~ 1,
        ISCO == 1120 ~ 1,
        ISCO == 1130 ~ 1,
        ISCO == 1210 ~ 1,
        ISCO == 1222 ~ 1,
        ISCO == 1223 ~ 1,
        ISCO == 1224 ~ 1,
        ISCO == 1225 ~ 1,
        ISCO == 1226 ~ 1,
        ISCO == 1227 ~ 1,
        ISCO == 1228 ~ 1,
        ISCO == 1229 ~ 1,
        ISCO == 1231 ~ 1,
        ISCO == 1232 ~ 1,
        ISCO == 1233 ~ 1,
        ISCO == 1234 ~ 1,
        ISCO == 1235 ~ 1,
        ISCO == 1236 ~ 1,
        ISCO == 1237 ~ 1,
        ISCO == 1239 ~ 1,
        ISCO == 2111 ~ 1,
        ISCO == 2112 ~ 1,
        ISCO == 2113 ~ 1,
        ISCO == 2114 ~ 1,
        ISCO == 2121 ~ 1,
        ISCO == 2122 ~ 1,
        ISCO == 2131 ~ 1,
        ISCO == 2141 ~ 1,
        ISCO == 2142 ~ 1,
        ISCO == 2143 ~ 1,
        ISCO == 2144 ~ 1,
        ISCO == 2145 ~ 1,
        ISCO == 2146 ~ 1,
        ISCO == 2147 ~ 1,
        ISCO == 2148 ~ 1,
        ISCO == 2149 ~ 1,
        ISCO == 2211 ~ 1,
        ISCO == 2212 ~ 1,
        ISCO == 2213 ~ 1,
        ISCO == 2221 ~ 1,
        ISCO == 2222 ~ 1,
        ISCO == 2223 ~ 1,
        ISCO == 2224 ~ 1,
        ISCO == 2229 ~ 1,
        ISCO == 2310 ~ 1,
        ISCO == 2351 ~ 1,
        ISCO == 1000 ~ 1,
        ISCO == 1100 ~ 1,
        ISCO == 1200 ~ 1,
        ISCO == 1220 ~ 1,
        ISCO == 1230 ~ 1,
        ISCO == 1250 ~ 1,
        ISCO == 1251 ~ 1,
        ISCO == 2000 ~ 1,
        ISCO == 2100 ~ 1,
        ISCO == 2110 ~ 1,
        ISCO == 2120 ~ 1,
        ISCO == 2130 ~ 1,
        ISCO == 2140 ~ 1,
        ISCO == 2200 ~ 1,
        ISCO == 2210 ~ 1,
        ISCO == 2220 ~ 1,
        ISCO == 2350 ~ 1,
        ISCO == 2400 ~ 1,
        ISCO == 2420 ~ 1,
        ISCO == 2440 ~ 1,
        ISCO == 2352 ~ 2,
        ISCO == 2411 ~ 1,
        ISCO == 2421 ~ 1,
        ISCO == 2422 ~ 1,
        ISCO == 2429 ~ 1,
        ISCO == 2441 ~ 1,
        ISCO == 2442 ~ 1,
        ISCO == 2443 ~ 1,
        ISCO == 2445 ~ 1,
        ISCO == 3143 ~ 1,
        ISCO == 3144 ~ 2,
        ISCO == 2452 ~ 2,
        ISCO == 5151 ~ 2,
        ISCO == 2453 ~ 2,
        ISCO == 2460 ~ 2,
        ISCO == 3232 ~ 2,
        ISCO == 1143 ~ 2,
        ISCO == 3472 ~ 2,
        ISCO == 3471 ~ 2,
        ISCO == 3417 ~ 2,
        ISCO == 3413 ~ 2,
        ISCO == 3415 ~ 2,
        ISCO == 3225 ~ 2,
        ISCO == 2431 ~ 2,
        ISCO == 3231 ~ 2,
        ISCO == 2455 ~ 2,
        ISCO == 3224 ~ 2,
        ISCO == 3416 ~ 2,
        ISCO == 2359 ~ 3,
        ISCO == 3475 ~ 2,
        ISCO == 3431 ~ 2,
        ISCO == 3411 ~ 2,
        ISCO == 3122 ~ 2,
        ISCO == 2419 ~ 2,
        ISCO == 3450 ~ 2,
        ISCO == 3434 ~ 2,
        ISCO == 2332 ~ 3,
        ISCO == 2446 ~ 2,
        ISCO == 3449 ~ 2,
        ISCO == 2331 ~ 3,
        ISCO == 3432 ~ 2,
        ISCO == 2444 ~ 2,
        ISCO == 3422 ~ 2,
        ISCO == 3228 ~ 2,
        ISCO == 2451 ~ 2,
        ISCO == 3423 ~ 2,
        ISCO == 3227 ~ 2,
        ISCO == 3226 ~ 2,
        ISCO == 2230 ~ 2,
        ISCO == 2320 ~ 2,
        ISCO == 1141 ~ 2,
        ISCO == 1142 ~ 2,
        ISCO == 1312 ~ 2,
        ISCO == 1313 ~ 2,
        ISCO == 1314 ~ 2,
        ISCO == 1315 ~ 2,
        ISCO == 1316 ~ 2,
        ISCO == 1317 ~ 2,
        ISCO == 1318 ~ 2,
        ISCO == 1319 ~ 2,
        ISCO == 2132 ~ 2,
        ISCO == 2139 ~ 2,
        ISCO == 2340 ~ 2,
        ISCO == 2412 ~ 2,
        ISCO == 2454 ~ 2,
        ISCO == 3121 ~ 2,
        ISCO == 3221 ~ 2,
        ISCO == 3222 ~ 2,
        ISCO == 3223 ~ 2,
        ISCO == 3229 ~ 2,
        ISCO == 3241 ~ 2,
        ISCO == 3242 ~ 2,
        ISCO == 3310 ~ 2,
        ISCO == 3320 ~ 2,
        ISCO == 3412 ~ 2,
        ISCO == 3414 ~ 2,
        ISCO == 3419 ~ 2,
        ISCO == 3421 ~ 2,
        ISCO == 3429 ~ 2,
        ISCO == 3441 ~ 2,
        ISCO == 3442 ~ 2,
        ISCO == 3443 ~ 2,
        ISCO == 3444 ~ 2,
        ISCO == 3473 ~ 2,
        ISCO == 3474 ~ 2,
        ISCO == 5152 ~ 2,
        ISCO == 1140 ~ 2,
        ISCO == 1240 ~ 2,
        ISCO == 1252 ~ 2,
        ISCO == 1300 ~ 2,
        ISCO == 1310 ~ 2,
        ISCO == 2300 ~ 2,
        ISCO == 2321 ~ 2,
        ISCO == 2322 ~ 2,
        ISCO == 2323 ~ 2,
        ISCO == 2330 ~ 2,
        ISCO == 2410 ~ 2,
        ISCO == 2430 ~ 2,
        ISCO == 2450 ~ 2,
        ISCO == 3000 ~ 2,
        ISCO == 3100 ~ 2,
        ISCO == 3110 ~ 2,
        ISCO == 3120 ~ 2,
        ISCO == 3130 ~ 2,
        ISCO == 3140 ~ 2,
        ISCO == 3150 ~ 2,
        ISCO == 3200 ~ 2,
        ISCO == 3210 ~ 2,
        ISCO == 3220 ~ 2,
        ISCO == 3240 ~ 2,
        ISCO == 3400 ~ 2,
        ISCO == 3410 ~ 2,
        ISCO == 3420 ~ 2,
        ISCO == 3440 ~ 2,
        ISCO == 3451 ~ 2,
        ISCO == 3470 ~ 2,
        ISCO == 5150 ~ 2,
        ISCO == 2432 ~ 3,
        ISCO == 4213 ~ 4,
        ISCO == 5112 ~ 3,
        ISCO == 4132 ~ 3,
        ISCO == 4131 ~ 3,
        ISCO == 5113 ~ 3,
        ISCO == 4215 ~ 3,
        ISCO == 3340 ~ 3,
        ISCO == 4133 ~ 3,
        ISCO == 5210 ~ 3,
        ISCO == 5111 ~ 3,
        ISCO == 4141 ~ 3,
        ISCO == 4111 ~ 3,
        ISCO == 5162 ~ 3,
        ISCO == 4115 ~ 3,
        ISCO == 4121 ~ 3,
        ISCO == 3439 ~ 3,
        ISCO == 3433 ~ 3,
        ISCO == 4122 ~ 3,
        ISCO == 3330 ~ 3,
        ISCO == 3460 ~ 3,
        ISCO == 3480 ~ 3,
        ISCO == 4112 ~ 3,
        ISCO == 4113 ~ 3,
        ISCO == 4114 ~ 3,
        ISCO == 4143 ~ 3,
        ISCO == 4144 ~ 3,
        ISCO == 4190 ~ 3,
        ISCO == 4212 ~ 3,
        ISCO == 4214 ~ 3,
        ISCO == 4221 ~ 3,
        ISCO == 5161 ~ 3,
        ISCO == 3230 ~ 3,
        ISCO == 3300 ~ 3,
        ISCO == 3430 ~ 3,
        ISCO == 4000 ~ 3,
        ISCO == 4100 ~ 3,
        ISCO == 4110 ~ 3,
        ISCO == 4120 ~ 3,
        ISCO == 4130 ~ 3,
        ISCO == 4140 ~ 3,
        ISCO == 4200 ~ 3,
        ISCO == 4210 ~ 3,
        ISCO == 4220 ~ 3,
        ISCO == 5000 ~ 3,
        ISCO == 5100 ~ 3,
        ISCO == 5110 ~ 3,
        ISCO == 5120 ~ 3,
        ISCO == 5130 ~ 3,
        ISCO == 5200 ~ 3,
        ISCO == 9100 ~ 3,
        ISCO == 9110 ~ 3,
        ISCO == 5149 ~ 4,
        ISCO == 9152 ~ 4,
        ISCO == 5123 ~ 4,
        ISCO == 9113 ~ 4,
        ISCO == 9151 ~ 4,
        ISCO == 5220 ~ 4,
        ISCO == 4211 ~ 4,
        ISCO == 5139 ~ 4,
        ISCO == 4142 ~ 4,
        ISCO == 4222 ~ 4,
        ISCO == 4223 ~ 4,
        ISCO == 5132 ~ 4,
        ISCO == 5142 ~ 4,
        ISCO == 3452 ~ 7,
        ISCO == 7510 ~ 7,
        ISCO == 5140 ~ 8,
        ISCO == 5164 ~ 8,
        ISCO == 7000 ~ 8,
        ISCO == 7100 ~ 8,
        ISCO == 7110 ~ 8,
        ISCO == 7120 ~ 8,
        ISCO == 7130 ~ 8,
        ISCO == 7140 ~ 8,
        ISCO == 7200 ~ 8,
        ISCO == 7210 ~ 8,
        ISCO == 7220 ~ 8,
        ISCO == 7230 ~ 8,
        ISCO == 7240 ~ 8,
        ISCO == 7300 ~ 8,
        ISCO == 7310 ~ 8,
        ISCO == 7340 ~ 8,
        ISCO == 7400 ~ 8,
        ISCO == 7410 ~ 8,
        ISCO == 7420 ~ 8,
        ISCO == 7430 ~ 8,
        ISCO == 7440 ~ 8,
        ISCO == 7500 ~ 8,
        ISCO == 7520 ~ 8,
        ISCO == 8110 ~ 8,
        ISCO == 8120 ~ 8,
        ISCO == 8150 ~ 8,
        ISCO == 8160 ~ 8,
        ISCO == 8170 ~ 8,
        ISCO == 8210 ~ 8,
        ISCO == 5143 ~ 8,
        ISCO == 3142 ~ 8,
        ISCO == 7216 ~ 8,
        ISCO == 7242 ~ 8,
        ISCO == 7313 ~ 8,
        ISCO == 7243 ~ 8,
        ISCO == 7312 ~ 8,
        ISCO == 7233 ~ 8,
        ISCO == 7311 ~ 8,
        ISCO == 3115 ~ 8,
        ISCO == 3113 ~ 8,
        ISCO == 3131 ~ 8,
        ISCO == 7245 ~ 8,
        ISCO == 3117 ~ 8,
        ISCO == 7241 ~ 8,
        ISCO == 7222 ~ 8,
        ISCO == 7344 ~ 8,
        ISCO == 3112 ~ 8,
        ISCO == 7343 ~ 8,
        ISCO == 3114 ~ 8,
        ISCO == 3211 ~ 8,
        ISCO == 3132 ~ 8,
        ISCO == 3152 ~ 8,
        ISCO == 3116 ~ 8,
        ISCO == 3111 ~ 8,
        ISCO == 8151 ~ 8,
        ISCO == 3118 ~ 8,
        ISCO == 7232 ~ 8,
        ISCO == 3212 ~ 8,
        ISCO == 8311 ~ 8,
        ISCO == 3133 ~ 8,
        ISCO == 3119 ~ 8,
        ISCO == 8159 ~ 8,
        ISCO == 3123 ~ 8,
        ISCO == 3139 ~ 8,
        ISCO == 3141 ~ 8,
        ISCO == 3145 ~ 8,
        ISCO == 3151 ~ 8,
        ISCO == 3213 ~ 8,
        ISCO == 1221 ~ 9,
        ISCO == 5160 ~ 9,
        ISCO == 7234 ~ 9,
        ISCO == 7320 ~ 9,
        ISCO == 7330 ~ 9,
        ISCO == 7530 ~ 9,
        ISCO == 8000 ~ 9,
        ISCO == 8100 ~ 9,
        ISCO == 8130 ~ 9,
        ISCO == 8140 ~ 9,
        ISCO == 8200 ~ 9,
        ISCO == 8220 ~ 9,
        ISCO == 8230 ~ 9,
        ISCO == 8250 ~ 9,
        ISCO == 8260 ~ 9,
        ISCO == 8270 ~ 9,
        ISCO == 8280 ~ 9,
        ISCO == 8300 ~ 9,
        ISCO == 8310 ~ 9,
        ISCO == 8320 ~ 9,
        ISCO == 8330 ~ 9,
        ISCO == 8400 ~ 9,
        ISCO == 9000 ~ 9,
        ISCO == 9130 ~ 9,
        ISCO == 9140 ~ 9,
        ISCO == 9150 ~ 9,
        ISCO == 9160 ~ 9,
        ISCO == 9300 ~ 9,
        ISCO == 9310 ~ 9,
        ISCO == 9320 ~ 9,
        ISCO == 9330 ~ 9,
        ISCO == 1311 ~ 9,
        ISCO == 7424 ~ 9,
        ISCO == 7132 ~ 9,
        ISCO == 7321 ~ 9,
        ISCO == 8276 ~ 9,
        ISCO == 8112 ~ 9,
        ISCO == 7124 ~ 9,
        ISCO == 7122 ~ 9,
        ISCO == 8141 ~ 9,
        ISCO == 8340 ~ 9,
        ISCO == 7129 ~ 8,
        ISCO == 7123 ~ 9,
        ISCO == 8277 ~ 9,
        ISCO == 8332 ~ 9,
        ISCO == 7416 ~ 9,
        ISCO == 7432 ~ 9,
        ISCO == 8212 ~ 9,
        ISCO == 8278 ~ 9,
        ISCO == 8111 ~ 9,
        ISCO == 8271 ~ 9,
        ISCO == 7136 ~ 9,
        ISCO == 7113 ~ 9,
        ISCO == 5122 ~ 9,
        ISCO == 7141 ~ 9,
        ISCO == 7423 ~ 9,
        ISCO == 7214 ~ 9,
        ISCO == 8324 ~ 9,
        ISCO == 7441 ~ 9,
        ISCO == 7133 ~ 9,
        ISCO == 7411 ~ 9,
        ISCO == 7436 ~ 9,
        ISCO == 7422 ~ 9,
        ISCO == 8142 ~ 9,
        ISCO == 7431 ~ 9,
        ISCO == 8162 ~ 9,
        ISCO == 7412 ~ 9,
        ISCO == 8139 ~ 9,
        ISCO == 7435 ~ 9,
        ISCO == 7442 ~ 9,
        ISCO == 8262 ~ 9,
        ISCO == 8153 ~ 9,
        ISCO == 7231 ~ 9,
        ISCO == 8272 ~ 9,
        ISCO == 7213 ~ 9,
        ISCO == 8121 ~ 9,
        ISCO == 7134 ~ 9,
        ISCO == 8231 ~ 9,
        ISCO == 8333 ~ 9,
        ISCO == 8222 ~ 9,
        ISCO == 7135 ~ 9,
        ISCO == 8266 ~ 9,
        ISCO == 8223 ~ 9,
        ISCO == 8124 ~ 9,
        ISCO == 8322 ~ 9,
        ISCO == 7212 ~ 9,
        ISCO == 7421 ~ 9,
        ISCO == 7224 ~ 9,
        ISCO == 7137 ~ 9,
        ISCO == 8261 ~ 9,
        ISCO == 8122 ~ 9,
        ISCO == 8163 ~ 9,
        ISCO == 7211 ~ 9,
        ISCO == 7221 ~ 9,
        ISCO == 7345 ~ 9,
        ISCO == 8269 ~ 9,
        ISCO == 8152 ~ 9,
        ISCO == 7215 ~ 9,
        ISCO == 5141 ~ 9,
        ISCO == 8232 ~ 9,
        ISCO == 7322 ~ 9,
        ISCO == 8281 ~ 9,
        ISCO == 8264 ~ 9,
        ISCO == 7324 ~ 9,
        ISCO == 7131 ~ 9,
        ISCO == 8143 ~ 9,
        ISCO == 7341 ~ 9,
        ISCO == 8312 ~ 9,
        ISCO == 8113 ~ 9,
        ISCO == 8161 ~ 9,
        ISCO == 8253 ~ 9,
        ISCO == 5163 ~ 9,
        ISCO == 8251 ~ 9,
        ISCO == 7332 ~ 9,
        ISCO == 8240 ~ 9,
        ISCO == 7223 ~ 9,
        ISCO == 7433 ~ 9,
        ISCO == 8252 ~ 9,
        ISCO == 8283 ~ 9,
        ISCO == 5169 ~ 9,
        ISCO == 7415 ~ 9,
        ISCO == 7244 ~ 9,
        ISCO == 8221 ~ 9,
        ISCO == 8290 ~ 9,
        ISCO == 8155 ~ 8,
        ISCO == 8172 ~ 9,
        ISCO == 8154 ~ 8,
        ISCO == 7112 ~ 9,
        ISCO == 7121 ~ 9,
        ISCO == 7142 ~ 9,
        ISCO == 7143 ~ 9,
        ISCO == 7323 ~ 9,
        ISCO == 7331 ~ 9,
        ISCO == 7342 ~ 9,
        ISCO == 7346 ~ 9,
        ISCO == 7413 ~ 9,
        ISCO == 7414 ~ 9,
        ISCO == 7434 ~ 9,
        ISCO == 7437 ~ 9,
        ISCO == 8123 ~ 9,
        ISCO == 8131 ~ 9,
        ISCO == 8171 ~ 9,
        ISCO == 8211 ~ 9,
        ISCO == 8224 ~ 9,
        ISCO == 8229 ~ 9,
        ISCO == 8263 ~ 9,
        ISCO == 8265 ~ 9,
        ISCO == 8274 ~ 9,
        ISCO == 8275 ~ 9,
        ISCO == 8279 ~ 9,
        ISCO == 8282 ~ 9,
        ISCO == 8284 ~ 9,
        ISCO == 8285 ~ 9,
        ISCO == 8286 ~ 9,
        ISCO == 8321 ~ 9,
        ISCO == 8323 ~ 9,
        ISCO == 8334 ~ 9,
        ISCO == 9153 ~ 9,
        ISCO == 9313 ~ 9,
        ISCO == 8273 ~ 10,
        ISCO == 9120 ~ 10,
        ISCO == 9162 ~ 10,
        ISCO == 9311 ~ 10,
        ISCO == 9312 ~ 10,
        ISCO == 9321 ~ 10,
        ISCO == 5121 ~ 10,
        ISCO == 5131 ~ 10,
        ISCO == 5133 ~ 10,
        ISCO == 5230 ~ 10,
        ISCO == 9111 ~ 10,
        ISCO == 9112 ~ 10,
        ISCO == 9131 ~ 10,
        ISCO == 9132 ~ 10,
        ISCO == 9133 ~ 10,
        ISCO == 9141 ~ 10,
        ISCO == 9142 ~ 10,
        ISCO == 9161 ~ 10,
        ISCO == 9322 ~ 10,
        ISCO == 9331 ~ 10,
        ISCO == 9332 ~ 10,
        ISCO == 9333 ~ 10,
        ISCO == 7111 ~ 10,
        ISCO == 6000 ~ 10,
        ISCO == 6100 ~ 10,
        ISCO == 6110 ~ 10,
        ISCO == 6120 ~ 10,
        ISCO == 6134 ~ 10,
        ISCO == 6140 ~ 10,
        ISCO == 6150 ~ 10,
        ISCO == 9200 ~ 10,
        ISCO == 9210 ~ 10,
        ISCO == 6111 ~ 11,
        ISCO == 6112 ~ 11,
        ISCO == 6113 ~ 11,
        ISCO == 6114 ~ 11,
        ISCO == 6121 ~ 11,
        ISCO == 6122 ~ 11,
        ISCO == 6123 ~ 11,
        ISCO == 6124 ~ 11,
        ISCO == 6129 ~ 11,
        ISCO == 6130 ~ 11,
        ISCO == 6141 ~ 11,
        ISCO == 6142 ~ 11,
        ISCO == 6151 ~ 11,
        ISCO == 6152 ~ 11,
        ISCO == 6153 ~ 11,
        ISCO == 6154 ~ 11,
        ISCO == 6210 ~ 11,
        ISCO == 8331 ~ 11,
        ISCO == 9211 ~ 11,
        ISCO == 9212 ~ 11,
        ISCO == 9213 ~ 11,
        ISCO == 6131 ~ 11,
        ISCO == 6132 ~ 11,
        ISCO == 6133 ~ 11,
        ISCO == 6200 ~ 11),
      EGP11 = case_when(
        PosicaoOcupacao == 2 & ISIC != 10 & ISIC != 100 ~ 5,
        PosicaoOcupacao == 2 & ISIC == 10 &
          EGP11 %in% c(1:4,8:11) ~ 6,
        EGP11 == 11 & PosicaoOcupacao %in% c(0,3) ~ 7,
        TRUE ~ EGP11)
    ) |>
    select(-c(var_trabalhando, var_afastado, var_aprendiz, var_trabalho_consumo,
              var_buscou_emprego, var_posicao_ocupacao,var_codigo_ocupacao,all_of(var_cnae_censo)))

  censo <- dados |>
    left_join(censo_processing,
              by = c("id_dom","id_pes"),
              keep = FALSE)

  return(censo)
}

# teste -------------------------------------------------------------------

# dados = censo
# dados_cnae = tabela_cnae
# var_cnae_compatibilizacao = "CNAE_Dom2"
# compatibilizacao_cnae = TRUE
# construir_var_pea = TRUE
# var_cnae_censo = "v6471"
# var_trabalhando = "v6910"
# var_afastado = "v0652"
# var_aprendiz = "v0643"
# var_trabalho_consumo = "v0644"
# var_buscou_emprego = "v0654"
# var_posicao_ocupacao = "v0648"
# var_codigo_ocupacao = "v6461"
#
#   # variaveis que serao utilizadas
#   vars <- c(var_trabalhando,var_afastado,var_aprendiz,var_trabalho_consumo,var_buscou_emprego,
#             var_posicao_ocupacao, var_codigo_ocupacao)
#
#   # criacao da base menor de trabalho
#   if(compatibilizacao_cnae == TRUE){
#     if(var_cnae_compatibilizacao == "CNAE_Dom"){
#       censo_processing <- dados |>
#         select(id_dom, id_pes, all_of(var_cnae_censo), var_trabalhando = all_of(var_trabalhando),
#                var_afastado = all_of(var_afastado), var_aprendiz = all_of(var_aprendiz),
#                var_trabalho_consumo = all_of(var_trabalho_consumo),
#                var_buscou_emprego = all_of(var_buscou_emprego),
#                var_posicao_ocupacao = all_of(var_posicao_ocupacao),
#                var_codigo_ocupacao = all_of(var_codigo_ocupacao)) |>
#         left_join(
#           dados_cnae[,var_cnae_compatibilizacao] |> distinct(),
#           by = c("v4462" = "CNAE_Dom"),
#           keep = TRUE)
#     } else{
#       censo_processing <- dados |>
#         select(id_dom, id_pes, all_of(var_cnae_censo), var_trabalhando = all_of(var_trabalhando),
#                var_afastado = all_of(var_afastado), var_aprendiz = all_of(var_aprendiz),
#                var_trabalho_consumo = all_of(var_trabalho_consumo),
#                var_buscou_emprego = all_of(var_buscou_emprego),
#                var_posicao_ocupacao = all_of(var_posicao_ocupacao),
#                var_codigo_ocupacao = all_of(var_codigo_ocupacao)) |>
#         left_join(
#           dados_cnae[,var_cnae_compatibilizacao] |> distinct(),
#           by = c("v6471" = "CNAE_Dom2"),
#           keep = TRUE)
#     }
#   } else{
#     censo_processing <- censo |>
#       select(id_dom, id_pes, CNAE_Dom = var_cnae_censo, all_of(vars))
#   }
#
#   # criando variavesi de PEA, PO e PosicaoOcupacao
#   if(var_cnae_compatibilizacao == "CNAE_Dom"){
#     censo_processing <- censo_processing |>
#       mutate(
#         PEA = case_when(
#           var_trabalhando == 1 ~ 1,
#           var_trabalhando != 1 & var_afastado == 1 ~ 1,
#           var_trabalhando != 1 & var_aprendiz == 1 ~ 1,
#           var_trabalhando != 1 & var_trabalho_consumo == 1 ~ 1,
#           var_trabalhando != 1 & var_buscou_emprego == 1 ~ 1,
#           TRUE ~ 0),
#         PO = case_when(
#           var_trabalhando == 1 ~ 1,
#           var_trabalhando != 1 & var_afastado == 1 ~ 1,
#           var_trabalhando != 1 & var_aprendiz == 1 ~ 1,
#           var_trabalhando != 1 & var_trabalho_consumo == 1 ~ 1,
#           var_trabalhando != 1 & var_buscou_emprego == 1 &
#             var_afastado != 1 &
#             var_aprendiz != 1 &
#             var_trabalho_consumo != 1 ~ 0,
#           TRUE ~ 0),
#         PosicaoOcupacao = case_when(
#           var_posicao_ocupacao %in% c(7,8,9) ~ 0, #trabalhador familiar nao remunerado
#           var_posicao_ocupacao %in% c(1,2,3,4) ~ 1, #empregado
#           var_posicao_ocupacao == 5 ~ 2, #empregador
#           var_posicao_ocupacao == 6 ~ 3) #conta propria
#       ) |>
#       filter(PO == 1)
#   } else{
#     censo_processing <- censo_processing |>
#       mutate(
#         PEA = case_when(
#           var_trabalhando == 1 ~ 1,
#           var_trabalhando != 1 & var_afastado == 1 ~ 1,
#           var_trabalhando != 1 & var_aprendiz == 1 ~ 1,
#           var_trabalhando != 1 & var_trabalho_consumo == 1 ~ 1,
#           var_trabalhando != 1 & var_buscou_emprego == 1 ~ 1,
#           TRUE ~ 0),
#         PO = case_when(
#           var_trabalhando == 1 ~ 1,
#           var_trabalhando != 1 & var_afastado == 1 ~ 1,
#           var_trabalhando != 1 & var_aprendiz == 1 ~ 1,
#           var_trabalhando != 1 & var_trabalho_consumo == 1 ~ 1,
#           var_trabalhando != 1 & var_buscou_emprego == 1 &
#             var_afastado != 1 &
#             var_aprendiz != 1 &
#             var_trabalho_consumo != 1 ~ 0,
#           TRUE ~ 0),
#         PosicaoOcupacao = case_when(
#           var_posicao_ocupacao %in% c(7,8,9) ~ 0, #trabalhador familiar nao remunerado
#           var_posicao_ocupacao %in% c(1,2,3,4) ~ 1, #empregado
#           var_posicao_ocupacao == 6 ~ 2, #empregador
#           var_posicao_ocupacao == 5 ~ 3) #conta propria
#       ) |>
#       filter(PO == 1)
#   }
#
#   # Processamento das variaveis ISIC, ISCO, EGP
#   if(var_cnae_compatibilizacao == "CNAE_Dom"){
#     censo_processing <- censo_processing |>
#       mutate(
#         ISIC = case_when(
#           CNAE_Dom == 0 ~ 999, #NA
#           CNAE_Dom >= 1101 & CNAE_Dom <= 3002 ~ 10,
#           CNAE_Dom >= 5000 & CNAE_Dom <= 9000 ~ 20,
#           CNAE_Dom >= 10010 & CNAE_Dom <= 33002 ~ 30,
#           CNAE_Dom >= 35010 & CNAE_Dom <= 39000 ~ 40,
#           CNAE_Dom >= 41000 & CNAE_Dom <= 43000 ~ 50,
#           CNAE_Dom == 45020 ~ 114,
#           CNAE_Dom >= 45010 & CNAE_Dom <= 48100 ~ 60,
#           CNAE_Dom >= 49010 & CNAE_Dom <= 53002 ~ 80,
#           CNAE_Dom >= 55000 & CNAE_Dom <= 56999 ~ 70,
#           CNAE_Dom >= 58000 & CNAE_Dom <= 60002 ~ 114,
#           CNAE_Dom == 61000 ~ 80,
#           CNAE_Dom >= 62000 & CNAE_Dom <= 63000 ~ 111,
#           CNAE_Dom >= 64000 & CNAE_Dom <= 66002 ~ 90,
#           CNAE_Dom >= 68000 & CNAE_Dom <= 74000 ~ 111,
#           CNAE_Dom == 75000~ 113,
#           CNAE_Dom == 77010 | CNAE_Dom == 79000 ~ 114,
#           CNAE_Dom >= 77020 & CNAE_Dom <= 82009 ~ 111,
#           CNAE_Dom >= 84011 & CNAE_Dom <= 84020 ~ 100,
#           CNAE_Dom >= 85011 & CNAE_Dom <= 85999 ~ 112,
#           CNAE_Dom >= 86001 & CNAE_Dom <= 88000 ~ 113,
#           CNAE_Dom == 99000 | CNAE_Dom >= 90000 & CNAE_Dom <= 96090 ~ 114,
#           CNAE_Dom == 97000 ~ 120,
#           CNAE_Dom == 99999 ~ 999 #NA
#         )
#       )
#   } else{
#     censo_processing <- censo_processing |>
#       mutate(
#         ISIC = case_when(
#           CNAE_Dom2 == 0 ~ 999, #NA
#           CNAE_Dom2 >= 1101 & CNAE_Dom2 <= 3002 ~ 10,
#           CNAE_Dom2 >= 5000 & CNAE_Dom2 <= 9000 ~ 20,
#           CNAE_Dom2 >= 10010 & CNAE_Dom2 <= 33002 ~ 30,
#           CNAE_Dom2 >= 35010 & CNAE_Dom2 <= 39000 ~ 40,
#           CNAE_Dom2 >= 41000 & CNAE_Dom2 <= 43000 ~ 50,
#           CNAE_Dom2 == 45020 ~ 114,
#           CNAE_Dom2 >= 45010 & CNAE_Dom2 <= 48100 ~ 60,
#           CNAE_Dom2 >= 49010 & CNAE_Dom2 <= 53002 ~ 80,
#           CNAE_Dom2 >= 55000 & CNAE_Dom2 <= 56999 ~ 70,
#           CNAE_Dom2 >= 58000 & CNAE_Dom2 <= 60002 ~ 114,
#           CNAE_Dom2 == 61000 ~ 80,
#           CNAE_Dom2 >= 62000 & CNAE_Dom2 <= 63000 ~ 111,
#           CNAE_Dom2 >= 64000 & CNAE_Dom2 <= 66002 ~ 90,
#           CNAE_Dom2 >= 68000 & CNAE_Dom2 <= 74000 ~ 111,
#           CNAE_Dom2 == 75000~ 113,
#           CNAE_Dom2 == 77010 | CNAE_Dom2 == 79000 ~ 114,
#           CNAE_Dom2 >= 77020 & CNAE_Dom2 <= 82009 ~ 111,
#           CNAE_Dom2 >= 84011 & CNAE_Dom2 <= 84020 ~ 100,
#           CNAE_Dom2 >= 85011 & CNAE_Dom2 <= 85999 ~ 112,
#           CNAE_Dom2 >= 86001 & CNAE_Dom2 <= 88000 ~ 113,
#           CNAE_Dom2 == 99000 | CNAE_Dom2 >= 90000 & CNAE_Dom2 <= 96090 ~ 114,
#           CNAE_Dom2 == 97000 ~ 120,
#           CNAE_Dom2 == 99999 ~ 999 #NA
#         )
#       )
#   }
#
#   censo_processing <- censo_processing |>
#     mutate(
#       ISCO = case_when(
#         var_codigo_ocupacao >= 110 & var_codigo_ocupacao <= 999 | var_codigo_ocupacao == 5411 ~ 110,
#         var_codigo_ocupacao ==1111~1110,
#         var_codigo_ocupacao ==1113~1110,
#         var_codigo_ocupacao ==1112~1120,
#         var_codigo_ocupacao ==1114~1143,
#         var_codigo_ocupacao ==1120~1210,
#         var_codigo_ocupacao ==1311~1221,
#         var_codigo_ocupacao ==1312~1221,
#         var_codigo_ocupacao ==1321~1222,
#         var_codigo_ocupacao ==1322~1222,
#         var_codigo_ocupacao ==1323~1223,
#         var_codigo_ocupacao ==1420~1224,
#         var_codigo_ocupacao ==1411~1225,
#         var_codigo_ocupacao ==1412~1225,
#         var_codigo_ocupacao ==1324~1226,
#         var_codigo_ocupacao ==1330~1226,
#         var_codigo_ocupacao ==1219~1229,
#         var_codigo_ocupacao ==1346~1227,
#         var_codigo_ocupacao ==1213~1229,
#         var_codigo_ocupacao ==1341~1229,
#         var_codigo_ocupacao ==1342~1229,
#         var_codigo_ocupacao ==1343~1229,
#         var_codigo_ocupacao ==1344~1229,
#         var_codigo_ocupacao ==1345~1229,
#         var_codigo_ocupacao ==1349~1229,
#         var_codigo_ocupacao ==1431~1229,
#         var_codigo_ocupacao ==1439~1229,
#         var_codigo_ocupacao ==1211~1231,
#         var_codigo_ocupacao ==1212~1232,
#         var_codigo_ocupacao ==1221~1233,
#         var_codigo_ocupacao ==1222~1234,
#         var_codigo_ocupacao ==1223~1237,
#         var_codigo_ocupacao ==2111~2111,
#         var_codigo_ocupacao ==2112~2112,
#         var_codigo_ocupacao ==2113~2113,
#         var_codigo_ocupacao ==2114~2114,
#         var_codigo_ocupacao ==2120~2121,
#         var_codigo_ocupacao ==2511~2131,
#         var_codigo_ocupacao ==2512~2131,
#         var_codigo_ocupacao ==2513~2131,
#         var_codigo_ocupacao ==2514~2131,
#         var_codigo_ocupacao ==2519~2131,
#         var_codigo_ocupacao ==2521~2131,
#         var_codigo_ocupacao ==2522~2131,
#         var_codigo_ocupacao ==2523~2131,
#         var_codigo_ocupacao ==2529~2131,
#         var_codigo_ocupacao ==2161~2141,
#         var_codigo_ocupacao ==2162~2141,
#         var_codigo_ocupacao ==2164~2141,
#         var_codigo_ocupacao ==2142~2142,
#         var_codigo_ocupacao ==2151~2143,
#         var_codigo_ocupacao ==2152~2144,
#         var_codigo_ocupacao ==2153~2144,
#         var_codigo_ocupacao ==2144~2145,
#         var_codigo_ocupacao ==2145~2146,
#         var_codigo_ocupacao ==2146~2147,
#         var_codigo_ocupacao ==2165~2148,
#         var_codigo_ocupacao ==2141~2149,
#         var_codigo_ocupacao ==2143~2149,
#         var_codigo_ocupacao ==2149~2149,
#         var_codigo_ocupacao ==2131~2211,
#         var_codigo_ocupacao ==2133~2211,
#         var_codigo_ocupacao ==2132~2213,
#         var_codigo_ocupacao ==2211~2221,
#         var_codigo_ocupacao ==2212~2221,
#         var_codigo_ocupacao ==2261~2222,
#         var_codigo_ocupacao ==2250~2223,
#         var_codigo_ocupacao ==2262~2224,
#         var_codigo_ocupacao ==2263~2229,
#         var_codigo_ocupacao ==2266~2229,
#         var_codigo_ocupacao ==2269~2229,
#         var_codigo_ocupacao ==2221~2230,
#         var_codigo_ocupacao ==2222~2230,
#         var_codigo_ocupacao ==2310~2310,
#         var_codigo_ocupacao ==2330~2320,
#         var_codigo_ocupacao ==2341~2331,
#         var_codigo_ocupacao ==2342~2332,
#         var_codigo_ocupacao ==2351~2351,
#         var_codigo_ocupacao ==2320~2359,
#         var_codigo_ocupacao ==2352~2359,
#         var_codigo_ocupacao ==2353~2359,
#         var_codigo_ocupacao ==2354~2359,
#         var_codigo_ocupacao ==2355~2359,
#         var_codigo_ocupacao ==2356~2359,
#         var_codigo_ocupacao ==2359~2359,
#         var_codigo_ocupacao ==3423~2359,
#         var_codigo_ocupacao ==5165~2359,
#         var_codigo_ocupacao ==2411~2411,
#         var_codigo_ocupacao ==2412~2411,
#         var_codigo_ocupacao ==2423~2412,
#         var_codigo_ocupacao ==2424~2412,
#         var_codigo_ocupacao ==2413~2419,
#         var_codigo_ocupacao ==2421~2419,
#         var_codigo_ocupacao ==2422~2419,
#         var_codigo_ocupacao ==2431~2419,
#         var_codigo_ocupacao ==2432~2419,
#         var_codigo_ocupacao ==2611~2421,
#         var_codigo_ocupacao ==2619~2421,
#         var_codigo_ocupacao ==2612~2422,
#         var_codigo_ocupacao ==2621~2431,
#         var_codigo_ocupacao ==2622~2432,
#         var_codigo_ocupacao ==2631~2441,
#         var_codigo_ocupacao ==2632~2442,
#         var_codigo_ocupacao ==2633~2443,
#         var_codigo_ocupacao ==2643~2444,
#         var_codigo_ocupacao ==2634~2445,
#         var_codigo_ocupacao ==2635~2446,
#         var_codigo_ocupacao ==2641~2451,
#         var_codigo_ocupacao ==2642~2451,
#         var_codigo_ocupacao ==2651~2452,
#         var_codigo_ocupacao ==2652~2453,
#         var_codigo_ocupacao ==2653~2454,
#         var_codigo_ocupacao ==2654~2455,
#         var_codigo_ocupacao ==2655~2455,
#         var_codigo_ocupacao ==2659~2455,
#         var_codigo_ocupacao ==2636~2460,
#         var_codigo_ocupacao ==3111~3111,
#         var_codigo_ocupacao ==3139~3111,
#         var_codigo_ocupacao ==3112~3112,
#         var_codigo_ocupacao ==3113~3113,
#         var_codigo_ocupacao ==3114~3114,
#         var_codigo_ocupacao ==3522~3114,
#         var_codigo_ocupacao ==3115~3115,
#         var_codigo_ocupacao ==3116~3116,
#         var_codigo_ocupacao ==3117~3117,
#         var_codigo_ocupacao ==3118~3118,
#         var_codigo_ocupacao ==3119~3119,
#         var_codigo_ocupacao ==3511~3121,
#         var_codigo_ocupacao ==3512~3121,
#         var_codigo_ocupacao ==3513~3121,
#         var_codigo_ocupacao ==3514~3121,
#         var_codigo_ocupacao ==3431~3131,
#         var_codigo_ocupacao ==3521~3131,
#         var_codigo_ocupacao ==3211~3133,
#         var_codigo_ocupacao ==3151~3141,
#         var_codigo_ocupacao ==3152~3142,
#         var_codigo_ocupacao ==3153~3143,
#         var_codigo_ocupacao ==3154~3144,
#         var_codigo_ocupacao ==3155~3145,
#         var_codigo_ocupacao ==3257~3152,
#         var_codigo_ocupacao ==7543~3152,
#         var_codigo_ocupacao ==3141~3211,
#         var_codigo_ocupacao ==3212~3211,
#         var_codigo_ocupacao ==3142~3212,
#         var_codigo_ocupacao ==3143~3212,
#         var_codigo_ocupacao ==2240~3221,
#         var_codigo_ocupacao ==3256~3221,
#         var_codigo_ocupacao ==3252~3222,
#         var_codigo_ocupacao ==2265~3223,
#         var_codigo_ocupacao ==2267~3224,
#         var_codigo_ocupacao ==3254~3224,
#         var_codigo_ocupacao ==3214~3225,
#         var_codigo_ocupacao ==3251~3225,
#         var_codigo_ocupacao ==2264~3226,
#         var_codigo_ocupacao ==3255~3226,
#         var_codigo_ocupacao ==3240~3227,
#         var_codigo_ocupacao ==3213~3228,
#         var_codigo_ocupacao ==3259~3229,
#         var_codigo_ocupacao ==3221~3231,
#         var_codigo_ocupacao ==3222~3232,
#         var_codigo_ocupacao ==2230~3241,
#         var_codigo_ocupacao ==3230~3241,
#         var_codigo_ocupacao ==3413~3242,
#         var_codigo_ocupacao ==3311~3411,
#         var_codigo_ocupacao ==3312~3411,
#         var_codigo_ocupacao ==3321~3412,
#         var_codigo_ocupacao ==3334~3413,
#         var_codigo_ocupacao ==4221~3414,
#         var_codigo_ocupacao ==2433~3415,
#         var_codigo_ocupacao ==2434~3415,
#         var_codigo_ocupacao ==3322~3415,
#         var_codigo_ocupacao ==3339~3415,
#         var_codigo_ocupacao ==3323~3416,
#         var_codigo_ocupacao ==3315~3417,
#         var_codigo_ocupacao ==3324~3421,
#         var_codigo_ocupacao ==3331~3422,
#         var_codigo_ocupacao ==3351~3422,
#         var_codigo_ocupacao ==3333~3423,
#         var_codigo_ocupacao ==3341~3431,
#         var_codigo_ocupacao ==3342~3431,
#         var_codigo_ocupacao ==3343~3431,
#         var_codigo_ocupacao ==3344~3431,
#         var_codigo_ocupacao ==3411~3432,
#         var_codigo_ocupacao ==3313~3433,
#         var_codigo_ocupacao ==3314~3434,
#         var_codigo_ocupacao ==3332~3439,
#         var_codigo_ocupacao ==3433~3439,
#         var_codigo_ocupacao ==3435~3439,
#         var_codigo_ocupacao ==3352~3442,
#         var_codigo_ocupacao ==3353~3443,
#         var_codigo_ocupacao ==3354~3444,
#         var_codigo_ocupacao ==3359~3444,
#         var_codigo_ocupacao ==3355~3450,
#         var_codigo_ocupacao ==3412~3460,
#         var_codigo_ocupacao ==2163~3471,
#         var_codigo_ocupacao ==2166~3471,
#         var_codigo_ocupacao ==3432~3471,
#         var_codigo_ocupacao ==2656~3472,
#         var_codigo_ocupacao ==3421~3475,
#         var_codigo_ocupacao ==3422~3475,
#         var_codigo_ocupacao ==4131~4111,
#         var_codigo_ocupacao ==4132~4113,
#         var_codigo_ocupacao ==4120~4115,
#         var_codigo_ocupacao ==4211~4121,
#         var_codigo_ocupacao ==4311~4121,
#         var_codigo_ocupacao ==4313~4121,
#         var_codigo_ocupacao ==4227~4122,
#         var_codigo_ocupacao ==4312~4122,
#         var_codigo_ocupacao ==4321~4131,
#         var_codigo_ocupacao ==4322~4132,
#         var_codigo_ocupacao ==4323~4133,
#         var_codigo_ocupacao ==4411~4141,
#         var_codigo_ocupacao ==4415~4141,
#         var_codigo_ocupacao ==4412~4142,
#         var_codigo_ocupacao ==4413~4143,
#         var_codigo_ocupacao ==4414~4144,
#         var_codigo_ocupacao ==4110~4190,
#         var_codigo_ocupacao ==4416~4190,
#         var_codigo_ocupacao ==4419~4190,
#         var_codigo_ocupacao ==5230~4211,
#         var_codigo_ocupacao ==4212~4212,
#         var_codigo_ocupacao ==4213~4214,
#         var_codigo_ocupacao ==4214~4215,
#         var_codigo_ocupacao ==4224~4222,
#         var_codigo_ocupacao ==4225~4222,
#         var_codigo_ocupacao ==4226~4222,
#         var_codigo_ocupacao ==4229~4222,
#         var_codigo_ocupacao ==4222~4223,
#         var_codigo_ocupacao ==4223~4223,
#         var_codigo_ocupacao ==5111~5111,
#         var_codigo_ocupacao ==5112~5112,
#         var_codigo_ocupacao ==8331~5112,
#         var_codigo_ocupacao ==5113~5113,
#         var_codigo_ocupacao ==5151~5121,
#         var_codigo_ocupacao ==5152~5121,
#         var_codigo_ocupacao ==3434~5122,
#         var_codigo_ocupacao ==5120~5122,
#         var_codigo_ocupacao ==9411~5122,
#         var_codigo_ocupacao ==9412~5122,
#         var_codigo_ocupacao ==5131~5123,
#         var_codigo_ocupacao ==5132~5123,
#         var_codigo_ocupacao ==5311~5131,
#         var_codigo_ocupacao ==5312~5131,
#         var_codigo_ocupacao ==3258~5132,
#         var_codigo_ocupacao ==5321~5132,
#         var_codigo_ocupacao ==5329~5132,
#         var_codigo_ocupacao ==5322~5133,
#         var_codigo_ocupacao ==3253~5139,
#         var_codigo_ocupacao ==5164~5139,
#         var_codigo_ocupacao ==5141~5141,
#         var_codigo_ocupacao ==5142~5141,
#         var_codigo_ocupacao ==5162~5142,
#         var_codigo_ocupacao ==5163~5143,
#         var_codigo_ocupacao ==5169~5149,
#         var_codigo_ocupacao ==5161~5151,
#         var_codigo_ocupacao ==5412~5162,
#         var_codigo_ocupacao ==5413~5163,
#         var_codigo_ocupacao ==5414~9152,
#         var_codigo_ocupacao ==5419~5169,
#         var_codigo_ocupacao ==5241~5210,
#         var_codigo_ocupacao ==5221~5220,
#         var_codigo_ocupacao ==5222~5220,
#         var_codigo_ocupacao ==5223~5220,
#         var_codigo_ocupacao ==5242~5220,
#         var_codigo_ocupacao ==5245~5220,
#         var_codigo_ocupacao ==5246~5220,
#         var_codigo_ocupacao ==5249~5220,
#         var_codigo_ocupacao ==5211~5230,
#         var_codigo_ocupacao ==6111~6111,
#         var_codigo_ocupacao ==6114~6111,
#         var_codigo_ocupacao ==6112~6113,
#         var_codigo_ocupacao ==9214~9211,
#         var_codigo_ocupacao ==6121~6121,
#         var_codigo_ocupacao ==6122~6122,
#         var_codigo_ocupacao ==6123~6123,
#         var_codigo_ocupacao ==6129~6129,
#         var_codigo_ocupacao ==6130~6141,
#         var_codigo_ocupacao ==6210~6141,
#         var_codigo_ocupacao ==9215~9212,
#         var_codigo_ocupacao ==6221~6151,
#         var_codigo_ocupacao ==6225~6152,
#         var_codigo_ocupacao ==6224~6154,
#         var_codigo_ocupacao ==9216~9212,
#         var_codigo_ocupacao ==3121~7111,
#         var_codigo_ocupacao ==8111~7111,
#         var_codigo_ocupacao ==7542~7112,
#         var_codigo_ocupacao ==7113~7113,
#         var_codigo_ocupacao ==7111~7122,
#         var_codigo_ocupacao ==7112~7122,
#         var_codigo_ocupacao ==9312~7122,
#         var_codigo_ocupacao ==9313~7122,
#         var_codigo_ocupacao ==7114~7123,
#         var_codigo_ocupacao ==7115~7124,
#         var_codigo_ocupacao ==3123~7129,
#         var_codigo_ocupacao ==7119~7129,
#         var_codigo_ocupacao ==7121~7131,
#         var_codigo_ocupacao ==7122~7132,
#         var_codigo_ocupacao ==7123~7133,
#         var_codigo_ocupacao ==7124~7134,
#         var_codigo_ocupacao ==7125~7135,
#         var_codigo_ocupacao ==7126~7136,
#         var_codigo_ocupacao ==7411~7137,
#         var_codigo_ocupacao ==7131~7141,
#         var_codigo_ocupacao ==7132~7142,
#         var_codigo_ocupacao ==7133~7143,
#         var_codigo_ocupacao ==7544~7143,
#         var_codigo_ocupacao ==7211~7211,
#         var_codigo_ocupacao ==7212~7212,
#         var_codigo_ocupacao ==7213~7213,
#         var_codigo_ocupacao ==7214~7214,
#         var_codigo_ocupacao ==7215~7215,
#         var_codigo_ocupacao ==7541~7216,
#         var_codigo_ocupacao ==7221~7221,
#         var_codigo_ocupacao ==7222~7222,
#         var_codigo_ocupacao ==7223~7223,
#         var_codigo_ocupacao ==7224~7224,
#         var_codigo_ocupacao ==7231~7231,
#         var_codigo_ocupacao ==7234~7231,
#         var_codigo_ocupacao ==7232~7232,
#         var_codigo_ocupacao ==7127~7233,
#         var_codigo_ocupacao ==7233~7233,
#         var_codigo_ocupacao ==7412~7241,
#         var_codigo_ocupacao ==7421~7242,
#         var_codigo_ocupacao ==7422~7244,
#         var_codigo_ocupacao ==7413~7245,
#         var_codigo_ocupacao ==7311~7311,
#         var_codigo_ocupacao ==7312~7312,
#         var_codigo_ocupacao ==7313~7313,
#         var_codigo_ocupacao ==7314~7321,
#         var_codigo_ocupacao ==7315~7322,
#         var_codigo_ocupacao ==7316~7324,
#         var_codigo_ocupacao ==7317~7331,
#         var_codigo_ocupacao ==7319~7331,
#         var_codigo_ocupacao ==7549~7331,
#         var_codigo_ocupacao ==7318~7332,
#         var_codigo_ocupacao ==7321~7341,
#         var_codigo_ocupacao ==8132~7344,
#         var_codigo_ocupacao ==7323~7345,
#         var_codigo_ocupacao ==7511~7411,
#         var_codigo_ocupacao ==7512~7412,
#         var_codigo_ocupacao ==7513~7413,
#         var_codigo_ocupacao ==7514~7414,
#         var_codigo_ocupacao ==7515~7415,
#         var_codigo_ocupacao ==7516~7416,
#         var_codigo_ocupacao ==7521~7421,
#         var_codigo_ocupacao ==7522~7422,
#         var_codigo_ocupacao ==7523~7423,
#         var_codigo_ocupacao ==8152~8262,
#         var_codigo_ocupacao ==7531~7433,
#         var_codigo_ocupacao ==7532~7435,
#         var_codigo_ocupacao ==7533~7436,
#         var_codigo_ocupacao ==7534~7437,
#         var_codigo_ocupacao ==7535~7441,
#         var_codigo_ocupacao ==7536~7442,
#         var_codigo_ocupacao ==8112~8112,
#         var_codigo_ocupacao ==8113~8113,
#         var_codigo_ocupacao ==3135~8121,
#         var_codigo_ocupacao ==8121~8121,
#         var_codigo_ocupacao ==8181~8131,
#         var_codigo_ocupacao ==8172~8141,
#         var_codigo_ocupacao ==8171~8142,
#         var_codigo_ocupacao ==8131~8151,
#         var_codigo_ocupacao ==3133~8152,
#         var_codigo_ocupacao ==3134~8155,
#         var_codigo_ocupacao ==3131~8161,
#         var_codigo_ocupacao ==8182~8162,
#         var_codigo_ocupacao ==3132~8163,
#         var_codigo_ocupacao ==3122~8171,
#         var_codigo_ocupacao ==8114~8212,
#         var_codigo_ocupacao ==8122~8223,
#         var_codigo_ocupacao ==8141~8231,
#         var_codigo_ocupacao ==8142~8232,
#         var_codigo_ocupacao ==7322~8251,
#         var_codigo_ocupacao ==8143~8253,
#         var_codigo_ocupacao ==8151~8261,
#         var_codigo_ocupacao ==8153~8263,
#         var_codigo_ocupacao ==8154~8264,
#         var_codigo_ocupacao ==8157~8264,
#         var_codigo_ocupacao ==8155~8265,
#         var_codigo_ocupacao ==8156~8266,
#         var_codigo_ocupacao ==8159~8269,
#         var_codigo_ocupacao ==8160~8271,
#         var_codigo_ocupacao ==8211~8281,
#         var_codigo_ocupacao ==8212~8282,
#         var_codigo_ocupacao ==8189~8290,
#         var_codigo_ocupacao ==8219~8290,
#         var_codigo_ocupacao ==8311~8311,
#         var_codigo_ocupacao ==8312~8312,
#         var_codigo_ocupacao ==8321~8321,
#         var_codigo_ocupacao ==8322~8322,
#         var_codigo_ocupacao ==8332~8324,
#         var_codigo_ocupacao ==8341~8331,
#         var_codigo_ocupacao ==8342~8332,
#         var_codigo_ocupacao ==8343~8333,
#         var_codigo_ocupacao ==8344~8334,
#         var_codigo_ocupacao ==8350~8340,
#         var_codigo_ocupacao ==5212~9111,
#         var_codigo_ocupacao ==9520~9112,
#         var_codigo_ocupacao ==5243~9113,
#         var_codigo_ocupacao ==5244~9113,
#         var_codigo_ocupacao ==9510~9120,
#         var_codigo_ocupacao ==9111~9131,
#         var_codigo_ocupacao ==9112~9132,
#         var_codigo_ocupacao ==9129~9132,
#         var_codigo_ocupacao ==9121~9133,
#         var_codigo_ocupacao ==9122~9142,
#         var_codigo_ocupacao ==9123~9142,
#         var_codigo_ocupacao ==9621~9151,
#         var_codigo_ocupacao ==5153~9141,
#         var_codigo_ocupacao ==9623~9153,
#         var_codigo_ocupacao ==9611~9161,
#         var_codigo_ocupacao ==9612~9161,
#         var_codigo_ocupacao ==9613~9162,
#         var_codigo_ocupacao ==9622~9162,
#         var_codigo_ocupacao ==9624~9162,
#         var_codigo_ocupacao ==9211~9211,
#         var_codigo_ocupacao ==9212~9211,
#         var_codigo_ocupacao ==9213~9211,
#         var_codigo_ocupacao ==9311~9311,
#         var_codigo_ocupacao ==9329~9321,
#         var_codigo_ocupacao ==8183~9322,
#         var_codigo_ocupacao ==9321~9322,
#         var_codigo_ocupacao ==9331~9331,
#         var_codigo_ocupacao ==9332~9332,
#         var_codigo_ocupacao ==9333~9333,
#         var_codigo_ocupacao ==9334~9333,
#         var_codigo_ocupacao ==9629~999,
#         var_codigo_ocupacao ==9999~999,
#         var_codigo_ocupacao ==9998~999,
#         var_codigo_ocupacao ==9988~999,
#         var_codigo_ocupacao == 0 | var_codigo_ocupacao == 5168 ~ 999
#       )
#     ) |>
#     mutate(ISCO = case_when(
#       ISCO == 6122 & PosicaoOcupacao == 2 ~ 1311,
#       ISCO %in% c(1143,1210,1221:1227,1229,1231:1234,1237) & ISIC == 100 &
#         PosicaoOcupacao == 3 ~ 1120,
#       ISCO %in% c(9211, 6113) & ISIC %in% c(114, 120) ~ 9141,
#       PosicaoOcupacao == 1 & ISCO %in% c(6111, 6113, 6123, 6129) ~ 9211,
#       PosicaoOcupacao == 1 & ISCO %in% c(6121, 6122) ~ 9211,
#       PosicaoOcupacao == 1 & ISCO %in% c( 6141, 6142) ~ 9212,
#       PosicaoOcupacao == 1 & ISCO %in% c(6151:6154) ~ 9213,
#       PosicaoOcupacao == 1 & ISCO %in% c(6111, 6113, 6123, 6129) ~ 1311,
#       TRUE ~ ISCO)) |>
#     mutate(
#       EGP11 = case_when(
#         ISCO == 1110 ~ 1,
#         ISCO == 1120 ~ 1,
#         ISCO == 1130 ~ 1,
#         ISCO == 1210 ~ 1,
#         ISCO == 1222 ~ 1,
#         ISCO == 1223 ~ 1,
#         ISCO == 1224 ~ 1,
#         ISCO == 1225 ~ 1,
#         ISCO == 1226 ~ 1,
#         ISCO == 1227 ~ 1,
#         ISCO == 1228 ~ 1,
#         ISCO == 1229 ~ 1,
#         ISCO == 1231 ~ 1,
#         ISCO == 1232 ~ 1,
#         ISCO == 1233 ~ 1,
#         ISCO == 1234 ~ 1,
#         ISCO == 1235 ~ 1,
#         ISCO == 1236 ~ 1,
#         ISCO == 1237 ~ 1,
#         ISCO == 1239 ~ 1,
#         ISCO == 2111 ~ 1,
#         ISCO == 2112 ~ 1,
#         ISCO == 2113 ~ 1,
#         ISCO == 2114 ~ 1,
#         ISCO == 2121 ~ 1,
#         ISCO == 2122 ~ 1,
#         ISCO == 2131 ~ 1,
#         ISCO == 2141 ~ 1,
#         ISCO == 2142 ~ 1,
#         ISCO == 2143 ~ 1,
#         ISCO == 2144 ~ 1,
#         ISCO == 2145 ~ 1,
#         ISCO == 2146 ~ 1,
#         ISCO == 2147 ~ 1,
#         ISCO == 2148 ~ 1,
#         ISCO == 2149 ~ 1,
#         ISCO == 2211 ~ 1,
#         ISCO == 2212 ~ 1,
#         ISCO == 2213 ~ 1,
#         ISCO == 2221 ~ 1,
#         ISCO == 2222 ~ 1,
#         ISCO == 2223 ~ 1,
#         ISCO == 2224 ~ 1,
#         ISCO == 2229 ~ 1,
#         ISCO == 2310 ~ 1,
#         ISCO == 2351 ~ 1,
#         ISCO == 1000 ~ 1,
#         ISCO == 1100 ~ 1,
#         ISCO == 1200 ~ 1,
#         ISCO == 1220 ~ 1,
#         ISCO == 1230 ~ 1,
#         ISCO == 1250 ~ 1,
#         ISCO == 1251 ~ 1,
#         ISCO == 2000 ~ 1,
#         ISCO == 2100 ~ 1,
#         ISCO == 2110 ~ 1,
#         ISCO == 2120 ~ 1,
#         ISCO == 2130 ~ 1,
#         ISCO == 2140 ~ 1,
#         ISCO == 2200 ~ 1,
#         ISCO == 2210 ~ 1,
#         ISCO == 2220 ~ 1,
#         ISCO == 2350 ~ 1,
#         ISCO == 2400 ~ 1,
#         ISCO == 2420 ~ 1,
#         ISCO == 2440 ~ 1,
#         ISCO == 2352 ~ 2,
#         ISCO == 2411 ~ 1,
#         ISCO == 2421 ~ 1,
#         ISCO == 2422 ~ 1,
#         ISCO == 2429 ~ 1,
#         ISCO == 2441 ~ 1,
#         ISCO == 2442 ~ 1,
#         ISCO == 2443 ~ 1,
#         ISCO == 2445 ~ 1,
#         ISCO == 3143 ~ 1,
#         ISCO == 3144 ~ 2,
#         ISCO == 2452 ~ 2,
#         ISCO == 5151 ~ 2,
#         ISCO == 2453 ~ 2,
#         ISCO == 2460 ~ 2,
#         ISCO == 3232 ~ 2,
#         ISCO == 1143 ~ 2,
#         ISCO == 3472 ~ 2,
#         ISCO == 3471 ~ 2,
#         ISCO == 3417 ~ 2,
#         ISCO == 3413 ~ 2,
#         ISCO == 3415 ~ 2,
#         ISCO == 3225 ~ 2,
#         ISCO == 2431 ~ 2,
#         ISCO == 3231 ~ 2,
#         ISCO == 2455 ~ 2,
#         ISCO == 3224 ~ 2,
#         ISCO == 3416 ~ 2,
#         ISCO == 2359 ~ 3,
#         ISCO == 3475 ~ 2,
#         ISCO == 3431 ~ 2,
#         ISCO == 3411 ~ 2,
#         ISCO == 3122 ~ 2,
#         ISCO == 2419 ~ 2,
#         ISCO == 3450 ~ 2,
#         ISCO == 3434 ~ 2,
#         ISCO == 2332 ~ 3,
#         ISCO == 2446 ~ 2,
#         ISCO == 3449 ~ 2,
#         ISCO == 2331 ~ 3,
#         ISCO == 3432 ~ 2,
#         ISCO == 2444 ~ 2,
#         ISCO == 3422 ~ 2,
#         ISCO == 3228 ~ 2,
#         ISCO == 2451 ~ 2,
#         ISCO == 3423 ~ 2,
#         ISCO == 3227 ~ 2,
#         ISCO == 3226 ~ 2,
#         ISCO == 2230 ~ 2,
#         ISCO == 2320 ~ 2,
#         ISCO == 1141 ~ 2,
#         ISCO == 1142 ~ 2,
#         ISCO == 1312 ~ 2,
#         ISCO == 1313 ~ 2,
#         ISCO == 1314 ~ 2,
#         ISCO == 1315 ~ 2,
#         ISCO == 1316 ~ 2,
#         ISCO == 1317 ~ 2,
#         ISCO == 1318 ~ 2,
#         ISCO == 1319 ~ 2,
#         ISCO == 2132 ~ 2,
#         ISCO == 2139 ~ 2,
#         ISCO == 2340 ~ 2,
#         ISCO == 2412 ~ 2,
#         ISCO == 2454 ~ 2,
#         ISCO == 3121 ~ 2,
#         ISCO == 3221 ~ 2,
#         ISCO == 3222 ~ 2,
#         ISCO == 3223 ~ 2,
#         ISCO == 3229 ~ 2,
#         ISCO == 3241 ~ 2,
#         ISCO == 3242 ~ 2,
#         ISCO == 3310 ~ 2,
#         ISCO == 3320 ~ 2,
#         ISCO == 3412 ~ 2,
#         ISCO == 3414 ~ 2,
#         ISCO == 3419 ~ 2,
#         ISCO == 3421 ~ 2,
#         ISCO == 3429 ~ 2,
#         ISCO == 3441 ~ 2,
#         ISCO == 3442 ~ 2,
#         ISCO == 3443 ~ 2,
#         ISCO == 3444 ~ 2,
#         ISCO == 3473 ~ 2,
#         ISCO == 3474 ~ 2,
#         ISCO == 5152 ~ 2,
#         ISCO == 1140 ~ 2,
#         ISCO == 1240 ~ 2,
#         ISCO == 1252 ~ 2,
#         ISCO == 1300 ~ 2,
#         ISCO == 1310 ~ 2,
#         ISCO == 2300 ~ 2,
#         ISCO == 2321 ~ 2,
#         ISCO == 2322 ~ 2,
#         ISCO == 2323 ~ 2,
#         ISCO == 2330 ~ 2,
#         ISCO == 2410 ~ 2,
#         ISCO == 2430 ~ 2,
#         ISCO == 2450 ~ 2,
#         ISCO == 3000 ~ 2,
#         ISCO == 3100 ~ 2,
#         ISCO == 3110 ~ 2,
#         ISCO == 3120 ~ 2,
#         ISCO == 3130 ~ 2,
#         ISCO == 3140 ~ 2,
#         ISCO == 3150 ~ 2,
#         ISCO == 3200 ~ 2,
#         ISCO == 3210 ~ 2,
#         ISCO == 3220 ~ 2,
#         ISCO == 3240 ~ 2,
#         ISCO == 3400 ~ 2,
#         ISCO == 3410 ~ 2,
#         ISCO == 3420 ~ 2,
#         ISCO == 3440 ~ 2,
#         ISCO == 3451 ~ 2,
#         ISCO == 3470 ~ 2,
#         ISCO == 5150 ~ 2,
#         ISCO == 2432 ~ 3,
#         ISCO == 4213 ~ 4,
#         ISCO == 5112 ~ 3,
#         ISCO == 4132 ~ 3,
#         ISCO == 4131 ~ 3,
#         ISCO == 5113 ~ 3,
#         ISCO == 4215 ~ 3,
#         ISCO == 3340 ~ 3,
#         ISCO == 4133 ~ 3,
#         ISCO == 5210 ~ 3,
#         ISCO == 5111 ~ 3,
#         ISCO == 4141 ~ 3,
#         ISCO == 4111 ~ 3,
#         ISCO == 5162 ~ 3,
#         ISCO == 4115 ~ 3,
#         ISCO == 4121 ~ 3,
#         ISCO == 3439 ~ 3,
#         ISCO == 3433 ~ 3,
#         ISCO == 4122 ~ 3,
#         ISCO == 3330 ~ 3,
#         ISCO == 3460 ~ 3,
#         ISCO == 3480 ~ 3,
#         ISCO == 4112 ~ 3,
#         ISCO == 4113 ~ 3,
#         ISCO == 4114 ~ 3,
#         ISCO == 4143 ~ 3,
#         ISCO == 4144 ~ 3,
#         ISCO == 4190 ~ 3,
#         ISCO == 4212 ~ 3,
#         ISCO == 4214 ~ 3,
#         ISCO == 4221 ~ 3,
#         ISCO == 5161 ~ 3,
#         ISCO == 3230 ~ 3,
#         ISCO == 3300 ~ 3,
#         ISCO == 3430 ~ 3,
#         ISCO == 4000 ~ 3,
#         ISCO == 4100 ~ 3,
#         ISCO == 4110 ~ 3,
#         ISCO == 4120 ~ 3,
#         ISCO == 4130 ~ 3,
#         ISCO == 4140 ~ 3,
#         ISCO == 4200 ~ 3,
#         ISCO == 4210 ~ 3,
#         ISCO == 4220 ~ 3,
#         ISCO == 5000 ~ 3,
#         ISCO == 5100 ~ 3,
#         ISCO == 5110 ~ 3,
#         ISCO == 5120 ~ 3,
#         ISCO == 5130 ~ 3,
#         ISCO == 5200 ~ 3,
#         ISCO == 9100 ~ 3,
#         ISCO == 9110 ~ 3,
#         ISCO == 5149 ~ 4,
#         ISCO == 9152 ~ 4,
#         ISCO == 5123 ~ 4,
#         ISCO == 9113 ~ 4,
#         ISCO == 9151 ~ 4,
#         ISCO == 5220 ~ 4,
#         ISCO == 4211 ~ 4,
#         ISCO == 5139 ~ 4,
#         ISCO == 4142 ~ 4,
#         ISCO == 4222 ~ 4,
#         ISCO == 4223 ~ 4,
#         ISCO == 5132 ~ 4,
#         ISCO == 5142 ~ 4,
#         ISCO == 3452 ~ 7,
#         ISCO == 7510 ~ 7,
#         ISCO == 5140 ~ 8,
#         ISCO == 5164 ~ 8,
#         ISCO == 7000 ~ 8,
#         ISCO == 7100 ~ 8,
#         ISCO == 7110 ~ 8,
#         ISCO == 7120 ~ 8,
#         ISCO == 7130 ~ 8,
#         ISCO == 7140 ~ 8,
#         ISCO == 7200 ~ 8,
#         ISCO == 7210 ~ 8,
#         ISCO == 7220 ~ 8,
#         ISCO == 7230 ~ 8,
#         ISCO == 7240 ~ 8,
#         ISCO == 7300 ~ 8,
#         ISCO == 7310 ~ 8,
#         ISCO == 7340 ~ 8,
#         ISCO == 7400 ~ 8,
#         ISCO == 7410 ~ 8,
#         ISCO == 7420 ~ 8,
#         ISCO == 7430 ~ 8,
#         ISCO == 7440 ~ 8,
#         ISCO == 7500 ~ 8,
#         ISCO == 7520 ~ 8,
#         ISCO == 8110 ~ 8,
#         ISCO == 8120 ~ 8,
#         ISCO == 8150 ~ 8,
#         ISCO == 8160 ~ 8,
#         ISCO == 8170 ~ 8,
#         ISCO == 8210 ~ 8,
#         ISCO == 5143 ~ 8,
#         ISCO == 3142 ~ 8,
#         ISCO == 7216 ~ 8,
#         ISCO == 7242 ~ 8,
#         ISCO == 7313 ~ 8,
#         ISCO == 7243 ~ 8,
#         ISCO == 7312 ~ 8,
#         ISCO == 7233 ~ 8,
#         ISCO == 7311 ~ 8,
#         ISCO == 3115 ~ 8,
#         ISCO == 3113 ~ 8,
#         ISCO == 3131 ~ 8,
#         ISCO == 7245 ~ 8,
#         ISCO == 3117 ~ 8,
#         ISCO == 7241 ~ 8,
#         ISCO == 7222 ~ 8,
#         ISCO == 7344 ~ 8,
#         ISCO == 3112 ~ 8,
#         ISCO == 7343 ~ 8,
#         ISCO == 3114 ~ 8,
#         ISCO == 3211 ~ 8,
#         ISCO == 3132 ~ 8,
#         ISCO == 3152 ~ 8,
#         ISCO == 3116 ~ 8,
#         ISCO == 3111 ~ 8,
#         ISCO == 8151 ~ 8,
#         ISCO == 3118 ~ 8,
#         ISCO == 7232 ~ 8,
#         ISCO == 3212 ~ 8,
#         ISCO == 8311 ~ 8,
#         ISCO == 3133 ~ 8,
#         ISCO == 3119 ~ 8,
#         ISCO == 8159 ~ 8,
#         ISCO == 3123 ~ 8,
#         ISCO == 3139 ~ 8,
#         ISCO == 3141 ~ 8,
#         ISCO == 3145 ~ 8,
#         ISCO == 3151 ~ 8,
#         ISCO == 3213 ~ 8,
#         ISCO == 1221 ~ 9,
#         ISCO == 5160 ~ 9,
#         ISCO == 7234 ~ 9,
#         ISCO == 7320 ~ 9,
#         ISCO == 7330 ~ 9,
#         ISCO == 7530 ~ 9,
#         ISCO == 8000 ~ 9,
#         ISCO == 8100 ~ 9,
#         ISCO == 8130 ~ 9,
#         ISCO == 8140 ~ 9,
#         ISCO == 8200 ~ 9,
#         ISCO == 8220 ~ 9,
#         ISCO == 8230 ~ 9,
#         ISCO == 8250 ~ 9,
#         ISCO == 8260 ~ 9,
#         ISCO == 8270 ~ 9,
#         ISCO == 8280 ~ 9,
#         ISCO == 8300 ~ 9,
#         ISCO == 8310 ~ 9,
#         ISCO == 8320 ~ 9,
#         ISCO == 8330 ~ 9,
#         ISCO == 8400 ~ 9,
#         ISCO == 9000 ~ 9,
#         ISCO == 9130 ~ 9,
#         ISCO == 9140 ~ 9,
#         ISCO == 9150 ~ 9,
#         ISCO == 9160 ~ 9,
#         ISCO == 9300 ~ 9,
#         ISCO == 9310 ~ 9,
#         ISCO == 9320 ~ 9,
#         ISCO == 9330 ~ 9,
#         ISCO == 1311 ~ 9,
#         ISCO == 7424 ~ 9,
#         ISCO == 7132 ~ 9,
#         ISCO == 7321 ~ 9,
#         ISCO == 8276 ~ 9,
#         ISCO == 8112 ~ 9,
#         ISCO == 7124 ~ 9,
#         ISCO == 7122 ~ 9,
#         ISCO == 8141 ~ 9,
#         ISCO == 8340 ~ 9,
#         ISCO == 7129 ~ 8,
#         ISCO == 7123 ~ 9,
#         ISCO == 8277 ~ 9,
#         ISCO == 8332 ~ 9,
#         ISCO == 7416 ~ 9,
#         ISCO == 7432 ~ 9,
#         ISCO == 8212 ~ 9,
#         ISCO == 8278 ~ 9,
#         ISCO == 8111 ~ 9,
#         ISCO == 8271 ~ 9,
#         ISCO == 7136 ~ 9,
#         ISCO == 7113 ~ 9,
#         ISCO == 5122 ~ 9,
#         ISCO == 7141 ~ 9,
#         ISCO == 7423 ~ 9,
#         ISCO == 7214 ~ 9,
#         ISCO == 8324 ~ 9,
#         ISCO == 7441 ~ 9,
#         ISCO == 7133 ~ 9,
#         ISCO == 7411 ~ 9,
#         ISCO == 7436 ~ 9,
#         ISCO == 7422 ~ 9,
#         ISCO == 8142 ~ 9,
#         ISCO == 7431 ~ 9,
#         ISCO == 8162 ~ 9,
#         ISCO == 7412 ~ 9,
#         ISCO == 8139 ~ 9,
#         ISCO == 7435 ~ 9,
#         ISCO == 7442 ~ 9,
#         ISCO == 8262 ~ 9,
#         ISCO == 8153 ~ 9,
#         ISCO == 7231 ~ 9,
#         ISCO == 8272 ~ 9,
#         ISCO == 7213 ~ 9,
#         ISCO == 8121 ~ 9,
#         ISCO == 7134 ~ 9,
#         ISCO == 8231 ~ 9,
#         ISCO == 8333 ~ 9,
#         ISCO == 8222 ~ 9,
#         ISCO == 7135 ~ 9,
#         ISCO == 8266 ~ 9,
#         ISCO == 8223 ~ 9,
#         ISCO == 8124 ~ 9,
#         ISCO == 8322 ~ 9,
#         ISCO == 7212 ~ 9,
#         ISCO == 7421 ~ 9,
#         ISCO == 7224 ~ 9,
#         ISCO == 7137 ~ 9,
#         ISCO == 8261 ~ 9,
#         ISCO == 8122 ~ 9,
#         ISCO == 8163 ~ 9,
#         ISCO == 7211 ~ 9,
#         ISCO == 7221 ~ 9,
#         ISCO == 7345 ~ 9,
#         ISCO == 8269 ~ 9,
#         ISCO == 8152 ~ 9,
#         ISCO == 7215 ~ 9,
#         ISCO == 5141 ~ 9,
#         ISCO == 8232 ~ 9,
#         ISCO == 7322 ~ 9,
#         ISCO == 8281 ~ 9,
#         ISCO == 8264 ~ 9,
#         ISCO == 7324 ~ 9,
#         ISCO == 7131 ~ 9,
#         ISCO == 8143 ~ 9,
#         ISCO == 7341 ~ 9,
#         ISCO == 8312 ~ 9,
#         ISCO == 8113 ~ 9,
#         ISCO == 8161 ~ 9,
#         ISCO == 8253 ~ 9,
#         ISCO == 5163 ~ 9,
#         ISCO == 8251 ~ 9,
#         ISCO == 7332 ~ 9,
#         ISCO == 8240 ~ 9,
#         ISCO == 7223 ~ 9,
#         ISCO == 7433 ~ 9,
#         ISCO == 8252 ~ 9,
#         ISCO == 8283 ~ 9,
#         ISCO == 5169 ~ 9,
#         ISCO == 7415 ~ 9,
#         ISCO == 7244 ~ 9,
#         ISCO == 8221 ~ 9,
#         ISCO == 8290 ~ 9,
#         ISCO == 8155 ~ 8,
#         ISCO == 8172 ~ 9,
#         ISCO == 8154 ~ 8,
#         ISCO == 7112 ~ 9,
#         ISCO == 7121 ~ 9,
#         ISCO == 7142 ~ 9,
#         ISCO == 7143 ~ 9,
#         ISCO == 7323 ~ 9,
#         ISCO == 7331 ~ 9,
#         ISCO == 7342 ~ 9,
#         ISCO == 7346 ~ 9,
#         ISCO == 7413 ~ 9,
#         ISCO == 7414 ~ 9,
#         ISCO == 7434 ~ 9,
#         ISCO == 7437 ~ 9,
#         ISCO == 8123 ~ 9,
#         ISCO == 8131 ~ 9,
#         ISCO == 8171 ~ 9,
#         ISCO == 8211 ~ 9,
#         ISCO == 8224 ~ 9,
#         ISCO == 8229 ~ 9,
#         ISCO == 8263 ~ 9,
#         ISCO == 8265 ~ 9,
#         ISCO == 8274 ~ 9,
#         ISCO == 8275 ~ 9,
#         ISCO == 8279 ~ 9,
#         ISCO == 8282 ~ 9,
#         ISCO == 8284 ~ 9,
#         ISCO == 8285 ~ 9,
#         ISCO == 8286 ~ 9,
#         ISCO == 8321 ~ 9,
#         ISCO == 8323 ~ 9,
#         ISCO == 8334 ~ 9,
#         ISCO == 9153 ~ 9,
#         ISCO == 9313 ~ 9,
#         ISCO == 8273 ~ 10,
#         ISCO == 9120 ~ 10,
#         ISCO == 9162 ~ 10,
#         ISCO == 9311 ~ 10,
#         ISCO == 9312 ~ 10,
#         ISCO == 9321 ~ 10,
#         ISCO == 5121 ~ 10,
#         ISCO == 5131 ~ 10,
#         ISCO == 5133 ~ 10,
#         ISCO == 5230 ~ 10,
#         ISCO == 9111 ~ 10,
#         ISCO == 9112 ~ 10,
#         ISCO == 9131 ~ 10,
#         ISCO == 9132 ~ 10,
#         ISCO == 9133 ~ 10,
#         ISCO == 9141 ~ 10,
#         ISCO == 9142 ~ 10,
#         ISCO == 9161 ~ 10,
#         ISCO == 9322 ~ 10,
#         ISCO == 9331 ~ 10,
#         ISCO == 9332 ~ 10,
#         ISCO == 9333 ~ 10,
#         ISCO == 7111 ~ 10,
#         ISCO == 6000 ~ 10,
#         ISCO == 6100 ~ 10,
#         ISCO == 6110 ~ 10,
#         ISCO == 6120 ~ 10,
#         ISCO == 6134 ~ 10,
#         ISCO == 6140 ~ 10,
#         ISCO == 6150 ~ 10,
#         ISCO == 9200 ~ 10,
#         ISCO == 9210 ~ 10,
#         ISCO == 6111 ~ 11,
#         ISCO == 6112 ~ 11,
#         ISCO == 6113 ~ 11,
#         ISCO == 6114 ~ 11,
#         ISCO == 6121 ~ 11,
#         ISCO == 6122 ~ 11,
#         ISCO == 6123 ~ 11,
#         ISCO == 6124 ~ 11,
#         ISCO == 6129 ~ 11,
#         ISCO == 6130 ~ 11,
#         ISCO == 6141 ~ 11,
#         ISCO == 6142 ~ 11,
#         ISCO == 6151 ~ 11,
#         ISCO == 6152 ~ 11,
#         ISCO == 6153 ~ 11,
#         ISCO == 6154 ~ 11,
#         ISCO == 6210 ~ 11,
#         ISCO == 8331 ~ 11,
#         ISCO == 9211 ~ 11,
#         ISCO == 9212 ~ 11,
#         ISCO == 9213 ~ 11,
#         ISCO == 6131 ~ 11,
#         ISCO == 6132 ~ 11,
#         ISCO == 6133 ~ 11,
#         ISCO == 6200 ~ 11),
#       EGP11 = case_when(
#         PosicaoOcupacao == 2 & ISIC != 10 & ISIC != 100 ~ 5,
#         PosicaoOcupacao == 2 & ISIC == 10 &
#           EGP11 %in% c(1:4,8:11) ~ 6,
#         EGP11 == 11 & PosicaoOcupacao %in% c(0,3) ~ 7,
#         TRUE ~ EGP11)
#     ) |>
#     select(-c(var_trabalhando, var_afastado, var_aprendiz, var_trabalho_consumo,
#               var_buscou_emprego, var_posicao_ocupacao,var_codigo_ocupacao,all_of(var_cnae_censo)))
#
#   censo <- dados |>
#     left_join(censo_processing,
#               by = c("id_dom","id_pes"),
#               keep = FALSE)
#
# # 2000
#
# censo_2000_terra_da_garoa <- func_tratamento_classes_egp(
#   dados = censo_2000_SP
# )
#
# censo_2000_terra_da_garoa |>
#   filter(v4572 >= 10 & PO == 1 & !is.na(EGP11)) |>
#   as_survey_design(ids = id_pes, weights = p001) |>
#   group_by(EGP11) |>
#   summarise(prop = round(survey_mean(na.rm = T)*100,2),
#             inc = survey_mean(v4614_defl, na.rm = T)) |>
#   arrange(desc(inc))
#
# # 2010
#
# censo_2010_terra_da_garoa <- func_tratamento_classes_egp(
#   dados = censo_2010_SP2_RM,
#   dados_cnae = tabela_cnae,
#   var_cnae_censo = "v6471",
#   var_cnae_compatibilizacao = "CNAE_Dom2",
#   compatibilizacao_cnae = TRUE,
#   construir_var_pea = TRUE,
#   var_trabalhando = "v6910",
#   var_afastado = "v0652",
#   var_aprendiz = "v0643",
#   var_trabalho_consumo = "v0644",
#   var_buscou_emprego = "v0654",
#   var_posicao_ocupacao = "v0648",
#   var_codigo_ocupacao = "v6461"
# )
#
# censo_2010_terra_da_garoa |>
#   filter(v6036 >= 10 & PO == 1 & !is.na(EGP11)) |>
#   as_survey_design(ids = id_pes, weights = v0010) |>
#   group_by(EGP11) |>
#   summarise(prop = round(survey_mean(na.rm = T)*100,2),
#             inc = survey_mean(v6527_defl, na.rm = T)) |>
#   arrange(desc(inc))

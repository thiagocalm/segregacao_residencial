# funcao --------------------------------------------------------------------

func_tratamento_classes_egp <- function(
    dados = censo,
    year = ano,
    var_cnae_censo = "v4462",
    var_trabalhando = "v0439",
    var_afastado = "v0440",
    var_aprendiz = "v0441",
    var_trabalho_cultivo = "v0442",
    var_trabalho_consumo = "v0443",
    var_buscou_emprego = "v0455",
    var_posicao_ocupacao = "v0447",
    var_codigo_ocupacao = "v4452"){

  # Carregamento de pacotes
  require(readxl)
  require(tidyverse)

  # variaveis que serao utilizadas
  vars <- c(var_trabalhando,var_afastado,var_aprendiz,var_trabalho_consumo,var_buscou_emprego,
            var_posicao_ocupacao, var_codigo_ocupacao)

  # importacao da base para conversao da CBO em ISCO
  tabela_cbo <- readxl::read_excel(
    "./docs/de_para_ocupacoes.xlsx",
    sheet = paste0("Conversão - ",year)
  ) |>
    select(cod_censo = 1, cod_isco = 4) |>
    mutate(across(everything(),~as.numeric(.x)))

  ## criacao da base menor de trabalho

  print(paste0("Começando processo de compatibilização..."))

  censo_processing <- censo |>
    select(
      id_dom, id_pes,
      var_cnae_censo = any_of(var_cnae_censo),
      var_trabalhando = any_of(var_trabalhando),
      var_afastado = any_of(var_afastado),
      var_aprendiz = any_of(var_aprendiz),
      var_trabalho_cultivo = any_of(var_trabalho_cultivo),
      var_trabalho_consumo = any_of(var_trabalho_consumo),
      var_buscou_emprego = any_of(var_buscou_emprego),
      var_posicao_ocupacao = any_of(var_posicao_ocupacao),
      var_codigo_ocupacao = any_of(var_codigo_ocupacao)
    )

  print(paste0("Começando processo de criacao de variaveis..."))


  # criando variavesi de PEA, PO e PosicaoOcupacao
  if(year ==2000){
    censo_processing <- censo_processing |>
      mutate(
        PEA = case_when(
          var_trabalhando == 1 ~ 1,
          var_trabalhando != 1 & var_afastado == 1 ~ 1,
          var_trabalhando != 1 & var_aprendiz == 1 ~ 1,
          var_trabalhando != 1 & var_trabalho_cultivo == 1 ~ 1,
          var_trabalhando != 1 & var_trabalho_consumo == 1 ~ 1,
          var_trabalhando != 1 & var_buscou_emprego == 1 ~ 1,
          TRUE ~ 0),
        PO = case_when(
          var_trabalhando == 1 ~ 1,
          var_trabalhando != 1 & var_afastado == 1 ~ 1,
          var_trabalhando != 1 & var_aprendiz == 1 ~ 1,
          var_trabalhando != 1 & var_trabalho_cultivo == 1 ~ 1,
          var_trabalhando != 1 & var_trabalho_consumo == 1 ~ 1,
          var_trabalhando != 1 & var_buscou_emprego == 1 &
            var_afastado != 1 &
            var_aprendiz != 1 &
            var_trabalho_consumo != 1 ~ 0,
          TRUE ~ 0),
        PosicaoOcupacao = case_when(
          var_posicao_ocupacao %in% c(7,8,9) ~ 0, #trabalhador familiar nao remunerado
          var_posicao_ocupacao %in% c(1,2,3,4) ~ 1, #empregado
          var_posicao_ocupacao == 5 ~ 2, #empregador
          var_posicao_ocupacao == 6 ~ 3) #conta propria
      )
  } else{
    censo_processing <- censo_processing |>
      mutate(
        PEA = case_when(
          var_trabalhando == 1 ~ 1,
          # var_trabalhando != 1 & var_afastado == 1 ~ 1,
          var_trabalhando != 1 & var_aprendiz == 1 ~ 1,
          var_trabalhando != 1 & var_trabalho_consumo == 1 ~ 1,
          var_trabalhando != 1 & var_buscou_emprego == 1 ~ 1,
          TRUE ~ 0),
        PO = case_when(
          var_trabalhando == 1 ~ 1,
          # var_trabalhando != 1 & var_afastado == 1 ~ 1,
          var_trabalhando != 1 & var_aprendiz == 1 ~ 1,
          var_trabalhando != 1 & var_trabalho_consumo == 1 ~ 1,
          var_trabalhando != 1 & var_buscou_emprego == 1 &
            # var_afastado != 1 &
            var_aprendiz != 1 &
            var_trabalho_consumo != 1 ~ 0,
          TRUE ~ 0),
        PosicaoOcupacao = case_when(
          var_posicao_ocupacao %in% c(7,8,9) ~ 0, #trabalhador familiar nao remunerado
          var_posicao_ocupacao %in% c(1,2,3,4) ~ 1, #empregado
          var_posicao_ocupacao == 6 ~ 2, #empregador
          var_posicao_ocupacao == 5 ~ 3) #conta propria
      )
  }

  if(year == 2000){

    # Transformacao CNAE > ISIC
    censo_processing <- censo_processing |>
      mutate(
        ISIC = case_when(
          var_cnae_censo %in% c(0,99999) ~ 999, #NA
          var_cnae_censo %in% 1101:5002 ~ 10,
          var_cnae_censo %in% 10000:14004 ~ 20,
          var_cnae_censo %in% 15010:37000 ~ 30,
          var_cnae_censo %in% 40010:41000 ~ 40,
          var_cnae_censo %in% 45001:45999 ~ 50,
          var_cnae_censo %in% c(50030:53102,53999) ~ 60,
          var_cnae_censo %in% 55010:55999 ~ 70,
          var_cnae_censo %in% c(60010:63022,64010:64020) ~ 80,
          var_cnae_censo %in% 65000:67020 ~ 90,
          var_cnae_censo %in% c(75011:75999) ~ 100,
          var_cnae_censo %in% c(70001:70002,71020,72010:74050,74090) ~ 111,
          var_cnae_censo %in% c(80011:80999) ~ 112,
          var_cnae_censo %in% c(74060,85011:85999) ~ 113,
          var_cnae_censo %in% c(50020,53111:53113,63030,71010,71030,90000:93092,99000) ~ 114,
          var_cnae_censo %in% c(95000) ~ 120
        )
      )

    print("Finalizou a criação do ISIC...")

    # Criacao da variavel ISCO
    censo_processing <- censo_processing |>
      left_join(
        tabela_cbo,
        by = c(var_codigo_ocupacao = "cod_censo"),
        keep = FALSE
      )

    censo_processing <- censo_processing |>
      mutate(
        ISCO = case_when(
          PosicaoOcupacao == 2 & var_codigo_ocupacao %in% c(6110,6129,6139) ~ 1311,
          ISIC == 10 & var_codigo_ocupacao %in% c(9914,5142) ~ 9113,
          ISIC == 80 & var_codigo_ocupacao %in% c(4231) ~ 4133,
          var_codigo_ocupacao %in% c(5211) ~ 5220,
          var_codigo_ocupacao %in% c(5211) &
            ((PosicaoOcupacao == 3 & ISIC == 60) | PosicaoOcupacao == 2) ~ 1314,
          var_codigo_ocupacao %in% c(5134) ~ 5123,
          var_codigo_ocupacao %in% c(5134) &
            ((PosicaoOcupacao == 3 & ISIC == 70) | PosicaoOcupacao == 2) ~ 1315,
          PosicaoOcupacao == 1 & cod_isco %in% c(6121, 6122) ~ 9211,
          PosicaoOcupacao == 1 & cod_isco %in% c( 6141, 6142) ~ 9212,
          PosicaoOcupacao == 1 & cod_isco %in% c(6151:6154) ~ 9213,
          cod_isco %in% c(1210, 1229) & PosicaoOcupacao == 0 & ISIC == 10 ~ 6111,
          cod_isco %in% c(1210, 1229) & PosicaoOcupacao != 0 & ISIC == 10 ~ 5220,
          cod_isco %in% c(1210, 1229) & PosicaoOcupacao %in% 2:3 & ISIC == 90 ~ 1317,
          cod_isco %in% c(1210, 1229) & PosicaoOcupacao %in% 1 & ISIC == 90 ~ 1227,
          cod_isco %in% c(1210, 1229) & PosicaoOcupacao %in% 2:3 & ISIC == 80 ~ 1316,
          cod_isco %in% c(1210, 1229) & PosicaoOcupacao %in% 1 & ISIC == 80 ~ 1226,
          cod_isco %in% c(1210, 1229) & PosicaoOcupacao %in% 2:3 & ISIC == 70 ~ 1315,
          cod_isco %in% c(1210, 1229) & PosicaoOcupacao %in% 1 & ISIC == 70 ~ 1225,
          cod_isco %in% c(1210, 1229) & PosicaoOcupacao %in% 2:3 & ISIC == 60 ~ 1314,
          cod_isco %in% c(1210, 1229) & PosicaoOcupacao %in% 1 & ISIC == 60 ~ 1224,
          cod_isco %in% c(1210, 1229) & PosicaoOcupacao %in% 2:3 & ISIC == 50 ~ 1313,
          cod_isco %in% c(1210, 1229) & PosicaoOcupacao %in% 1 & ISIC == 50 ~ 1223,
          cod_isco %in% c(1210, 1229) & PosicaoOcupacao %in% 2:3 & ISIC %in% 20:40 ~ 1312,
          cod_isco %in% c(1210, 1229) & PosicaoOcupacao %in% 1 & ISIC %in% 20:40 ~ 1222,
          cod_isco %in% c(1210, 1229) & ISIC %in% 100 ~ 1120,
          TRUE ~ cod_isco
        )
      )
    print("Finalizou a criação do ISCO...")
  }

  if(year == 2010){
    # Transformacao CNAE > ISIC
    censo_processing <- censo_processing |>
      mutate(
        ISIC = case_when(
          var_cnae_censo %in% c(0,99999) ~ 999, #NA
          var_cnae_censo %in% 1101:3002 ~ 10,
          var_cnae_censo %in% 5000:9000 ~ 20,
          var_cnae_censo %in% c(10010:33002,38000:39000) ~ 30,
          var_cnae_censo %in% 35010:37000 ~ 40,
          var_cnae_censo %in% 41000:43999 ~ 50,
          var_cnae_censo %in% c(45010,45030:48999) ~ 60,
          var_cnae_censo %in% 55000:56999 ~ 70,
          var_cnae_censo %in% c(49010:53002,61000) ~ 80,
          var_cnae_censo %in% 64000:66002 ~ 90,
          var_cnae_censo %in% c(84011:84999) ~ 100,
          var_cnae_censo %in% c(62000:63000,68000:74000,77020:78000,80000:82009) ~ 111,
          var_cnae_censo %in% c(85011:85999) ~ 112,
          var_cnae_censo %in% c(75000,86001:88000) ~ 113,
          var_cnae_censo %in% c(45020,58000:60002,77010,79000,90000:96090,99000) ~ 114,
          var_cnae_censo %in% c(97000) ~ 120
        )
      )

    print("Finalizou a criação do ISIC...")

    # Criacao da variavel ISCO
    censo_processing <- censo_processing |>
      left_join(
        tabela_cbo,
        by = c(var_codigo_ocupacao = "cod_censo"),
        keep = FALSE
      )

    censo_processing <- censo_processing |>
      mutate(
        ISCO = case_when(
          PosicaoOcupacao == 2 & var_codigo_ocupacao %in% c(6122,6121) ~ 1311,
          PosicaoOcupacao != 3 & ISIC == 100 &
            cod_isco %in% c(1143,1210,1221:1227,1229,1231:1234,1237) ~ 1120,
          ISIC %in% c(114,120) & cod_isco %in% c(9211,6113) ~ 9141,
          PosicaoOcupacao == 1 & cod_isco %in% c(6111, 6113,6121:6123,6129) ~ 9211,
          PosicaoOcupacao == 1 & cod_isco %in% c(6141, 6142) ~ 9212,
          PosicaoOcupacao == 1 & cod_isco %in% c(6151:6154) ~ 9213,
          PosicaoOcupacao == 2 & cod_isco %in% c(6111,6113,6123,6129) ~ 1311,
          TRUE ~ cod_isco
        )
      )
    print("Finalizou a criação do ISCO...")

  }
  invisible(gc())

  # Criacao da EGP
  censo_processing <- censo_processing |>
    mutate(
      EGP11 = case_when(
        ISCO == 1110 ~ 1,
        ISCO == 1120 ~ 1,
        ISCO == 1130 ~ 1,
        ISCO == 1210 ~ 1,
        ISCO == 1222 ~ 1,
        ISCO == 1223 ~ 1,
        ISCO == 1224 ~ 1,
        ISCO == 1225 ~ 1,
        ISCO == 1226 ~ 1,
        ISCO == 1227 ~ 1,
        ISCO == 1228 ~ 1,
        ISCO == 1229 ~ 1,
        ISCO == 1231 ~ 1,
        ISCO == 1232 ~ 1,
        ISCO == 1233 ~ 1,
        ISCO == 1234 ~ 1,
        ISCO == 1235 ~ 1,
        ISCO == 1236 ~ 1,
        ISCO == 1237 ~ 1,
        ISCO == 1239 ~ 1,
        ISCO == 2111 ~ 1,
        ISCO == 2112 ~ 1,
        ISCO == 2113 ~ 1,
        ISCO == 2114 ~ 1,
        ISCO == 2121 ~ 1,
        ISCO == 2122 ~ 1,
        ISCO == 2131 ~ 1,
        ISCO == 2141 ~ 1,
        ISCO == 2142 ~ 1,
        ISCO == 2143 ~ 1,
        ISCO == 2144 ~ 1,
        ISCO == 2145 ~ 1,
        ISCO == 2146 ~ 1,
        ISCO == 2147 ~ 1,
        ISCO == 2148 ~ 1,
        ISCO == 2149 ~ 1,
        ISCO == 2211 ~ 1,
        ISCO == 2212 ~ 1,
        ISCO == 2213 ~ 1,
        ISCO == 2221 ~ 1,
        ISCO == 2222 ~ 1,
        ISCO == 2223 ~ 1,
        ISCO == 2224 ~ 1,
        ISCO == 2229 ~ 1,
        ISCO == 2310 ~ 1,
        ISCO == 2351 ~ 1,
        ISCO == 1000 ~ 1,
        ISCO == 1100 ~ 1,
        ISCO == 1200 ~ 1,
        ISCO == 1220 ~ 1,
        ISCO == 1230 ~ 1,
        ISCO == 1250 ~ 1,
        ISCO == 1251 ~ 1,
        ISCO == 2000 ~ 1,
        ISCO == 2100 ~ 1,
        ISCO == 2110 ~ 1,
        ISCO == 2120 ~ 1,
        ISCO == 2130 ~ 1,
        ISCO == 2140 ~ 1,
        ISCO == 2200 ~ 1,
        ISCO == 2210 ~ 1,
        ISCO == 2220 ~ 1,
        ISCO == 2350 ~ 1,
        ISCO == 2400 ~ 1,
        ISCO == 2420 ~ 1,
        ISCO == 2440 ~ 1,
        ISCO == 2352 ~ 2,
        ISCO == 2411 ~ 1,
        ISCO == 2421 ~ 1,
        ISCO == 2422 ~ 1,
        ISCO == 2429 ~ 1,
        ISCO == 2441 ~ 1,
        ISCO == 2442 ~ 1,
        ISCO == 2443 ~ 1,
        ISCO == 2445 ~ 1,
        ISCO == 3143 ~ 1,
        ISCO == 3144 ~ 2,
        ISCO == 2452 ~ 2,
        ISCO == 5151 ~ 2,
        ISCO == 2453 ~ 2,
        ISCO == 2460 ~ 2,
        ISCO == 3232 ~ 2,
        ISCO == 1143 ~ 2,
        ISCO == 3472 ~ 2,
        ISCO == 3471 ~ 2,
        ISCO == 3417 ~ 2,
        ISCO == 3413 ~ 2,
        ISCO == 3415 ~ 2,
        ISCO == 3225 ~ 2,
        ISCO == 2431 ~ 2,
        ISCO == 3231 ~ 2,
        ISCO == 2455 ~ 2,
        ISCO == 3224 ~ 2,
        ISCO == 3416 ~ 2,
        ISCO == 3475 ~ 2,
        ISCO == 3431 ~ 2,
        ISCO == 3411 ~ 2,
        ISCO == 3122 ~ 2,
        ISCO == 2419 ~ 2,
        ISCO == 3450 ~ 2,
        ISCO == 3434 ~ 2,
        ISCO == 2446 ~ 2,
        ISCO == 3449 ~ 2,
        ISCO == 3432 ~ 2,
        ISCO == 2444 ~ 2,
        ISCO == 3422 ~ 2,
        ISCO == 3228 ~ 2,
        ISCO == 2451 ~ 2,
        ISCO == 3423 ~ 2,
        ISCO == 3227 ~ 2,
        ISCO == 3226 ~ 2,
        ISCO == 2230 ~ 2,
        ISCO == 2320 ~ 2,
        ISCO == 1141 ~ 2,
        ISCO == 1142 ~ 2,
        ISCO == 1312 ~ 2,
        ISCO == 1313 ~ 2,
        ISCO == 1314 ~ 2,
        ISCO == 1315 ~ 2,
        ISCO == 1316 ~ 2,
        ISCO == 1317 ~ 2,
        ISCO == 1318 ~ 2,
        ISCO == 1319 ~ 2,
        ISCO == 2132 ~ 2,
        ISCO == 2139 ~ 2,
        ISCO == 2340 ~ 2,
        ISCO == 2412 ~ 2,
        ISCO == 2454 ~ 2,
        ISCO == 3121 ~ 2,
        ISCO == 3221 ~ 2,
        ISCO == 3222 ~ 2,
        ISCO == 3223 ~ 2,
        ISCO == 3229 ~ 2,
        ISCO == 3241 ~ 2,
        ISCO == 3242 ~ 2,
        ISCO == 3310 ~ 2,
        ISCO == 3320 ~ 2,
        ISCO == 3412 ~ 2,
        ISCO == 3414 ~ 2,
        ISCO == 3419 ~ 2,
        ISCO == 3421 ~ 2,
        ISCO == 3429 ~ 2,
        ISCO == 3441 ~ 2,
        ISCO == 3442 ~ 2,
        ISCO == 3443 ~ 2,
        ISCO == 3444 ~ 2,
        ISCO == 3473 ~ 2,
        ISCO == 3474 ~ 2,
        ISCO == 5152 ~ 2,
        ISCO == 1140 ~ 2,
        ISCO == 1240 ~ 2,
        ISCO == 1252 ~ 2,
        ISCO == 1300 ~ 2,
        ISCO == 1310 ~ 2,
        ISCO == 2300 ~ 2,
        ISCO == 2321 ~ 2,
        ISCO == 2322 ~ 2,
        ISCO == 2323 ~ 2,
        ISCO == 2330 ~ 2,
        ISCO == 2410 ~ 2,
        ISCO == 2430 ~ 2,
        ISCO == 2450 ~ 2,
        ISCO == 3000 ~ 2,
        ISCO == 3100 ~ 2,
        ISCO == 3110 ~ 2,
        ISCO == 3120 ~ 2,
        ISCO == 3130 ~ 2,
        ISCO == 3140 ~ 2,
        ISCO == 3150 ~ 2,
        ISCO == 3200 ~ 2,
        ISCO == 3210 ~ 2,
        ISCO == 3220 ~ 2,
        ISCO == 3240 ~ 2,
        ISCO == 3400 ~ 2,
        ISCO == 3410 ~ 2,
        ISCO == 3420 ~ 2,
        ISCO == 3440 ~ 2,
        ISCO == 3451 ~ 2,
        ISCO == 3470 ~ 2,
        ISCO == 5150 ~ 2,
        ISCO == 2332 ~ 3,
        ISCO == 2331 ~ 3,
        ISCO == 2359 ~ 3,
        ISCO == 2432 ~ 3,
        ISCO == 5112 ~ 3,
        ISCO == 4132 ~ 3,
        ISCO == 4131 ~ 3,
        ISCO == 5113 ~ 3,
        ISCO == 4215 ~ 3,
        ISCO == 3340 ~ 3,
        ISCO == 4133 ~ 3,
        ISCO == 5210 ~ 3,
        ISCO == 5111 ~ 3,
        ISCO == 4141 ~ 3,
        ISCO == 4111 ~ 3,
        ISCO == 5162 ~ 3,
        ISCO == 4115 ~ 3,
        ISCO == 4121 ~ 3,
        ISCO == 3439 ~ 3,
        ISCO == 3433 ~ 3,
        ISCO == 4122 ~ 3,
        ISCO == 3330 ~ 3,
        ISCO == 3460 ~ 3,
        ISCO == 3480 ~ 3,
        ISCO == 4112 ~ 3,
        ISCO == 4113 ~ 3,
        ISCO == 4114 ~ 3,
        ISCO == 4143 ~ 3,
        ISCO == 4144 ~ 3,
        ISCO == 4190 ~ 3,
        ISCO == 4212 ~ 3,
        ISCO == 4214 ~ 3,
        ISCO == 4221 ~ 3,
        ISCO == 5161 ~ 3,
        ISCO == 3230 ~ 3,
        ISCO == 3300 ~ 3,
        ISCO == 3430 ~ 3,
        ISCO == 4000 ~ 3,
        ISCO == 4100 ~ 3,
        ISCO == 4110 ~ 3,
        ISCO == 4120 ~ 3,
        ISCO == 4130 ~ 3,
        ISCO == 4140 ~ 3,
        ISCO == 4200 ~ 3,
        ISCO == 4210 ~ 3,
        ISCO == 4220 ~ 3,
        ISCO == 5000 ~ 3,
        ISCO == 5100 ~ 3,
        ISCO == 5110 ~ 3,
        ISCO == 5120 ~ 3,
        ISCO == 5130 ~ 3,
        ISCO == 5200 ~ 3,
        ISCO == 9100 ~ 3,
        ISCO == 9110 ~ 3,
        ISCO == 4213 ~ 4,
        ISCO == 5149 ~ 4,
        ISCO == 9152 ~ 4,
        ISCO == 5123 ~ 4,
        ISCO == 9113 ~ 4,
        ISCO == 9151 ~ 4,
        ISCO == 5220 ~ 4,
        ISCO == 4211 ~ 4,
        ISCO == 5139 ~ 4,
        ISCO == 4142 ~ 4,
        ISCO == 4222 ~ 4,
        ISCO == 4223 ~ 4,
        ISCO == 5132 ~ 4,
        ISCO == 5142 ~ 4
      )
    )

  invisible(gc())

  # Criacao da EGP
  censo_processing <- censo_processing |>
    mutate(
      EGP11 = case_when(
        ISCO == 3452 ~ 7,
        ISCO == 7510 ~ 7,
        ISCO == 5140 ~ 8,
        ISCO == 5164 ~ 8,
        ISCO == 7000 ~ 8,
        ISCO == 7100 ~ 8,
        ISCO == 7110 ~ 8,
        ISCO == 7120 ~ 8,
        ISCO == 7130 ~ 8,
        ISCO == 7140 ~ 8,
        ISCO == 7200 ~ 8,
        ISCO == 7210 ~ 8,
        ISCO == 7220 ~ 8,
        ISCO == 7230 ~ 8,
        ISCO == 7240 ~ 8,
        ISCO == 7300 ~ 8,
        ISCO == 7310 ~ 8,
        ISCO == 7340 ~ 8,
        ISCO == 7400 ~ 8,
        ISCO == 7410 ~ 8,
        ISCO == 7420 ~ 8,
        ISCO == 7430 ~ 8,
        ISCO == 7440 ~ 8,
        ISCO == 7500 ~ 8,
        ISCO == 7520 ~ 8,
        ISCO == 8110 ~ 8,
        ISCO == 8120 ~ 8,
        ISCO == 8150 ~ 8,
        ISCO == 8160 ~ 8,
        ISCO == 8170 ~ 8,
        ISCO == 8210 ~ 8,
        ISCO == 5143 ~ 8,
        ISCO == 3142 ~ 8,
        ISCO == 7216 ~ 8,
        ISCO == 7242 ~ 8,
        ISCO == 7313 ~ 8,
        ISCO == 7243 ~ 8,
        ISCO == 7312 ~ 8,
        ISCO == 7233 ~ 8,
        ISCO == 7311 ~ 8,
        ISCO == 3115 ~ 8,
        ISCO == 3113 ~ 8,
        ISCO == 3131 ~ 8,
        ISCO == 7245 ~ 8,
        ISCO == 3117 ~ 8,
        ISCO == 7241 ~ 8,
        ISCO == 7222 ~ 8,
        ISCO == 7344 ~ 8,
        ISCO == 3112 ~ 8,
        ISCO == 7343 ~ 8,
        ISCO == 3114 ~ 8,
        ISCO == 3211 ~ 8,
        ISCO == 3132 ~ 8,
        ISCO == 3152 ~ 8,
        ISCO == 3116 ~ 8,
        ISCO == 3111 ~ 8,
        ISCO == 8151 ~ 8,
        ISCO == 3118 ~ 8,
        ISCO == 7232 ~ 8,
        ISCO == 3212 ~ 8,
        ISCO == 8311 ~ 8,
        ISCO == 3133 ~ 8,
        ISCO == 3119 ~ 8,
        ISCO == 8159 ~ 8,
        ISCO == 3123 ~ 8,
        ISCO == 3139 ~ 8,
        ISCO == 3141 ~ 8,
        ISCO == 3145 ~ 8,
        ISCO == 3151 ~ 8,
        ISCO == 3213 ~ 8,
        ISCO == 1221 ~ 9,
        ISCO == 5160 ~ 9,
        ISCO == 7234 ~ 9,
        ISCO == 7320 ~ 9,
        ISCO == 7330 ~ 9,
        ISCO == 7530 ~ 9,
        ISCO == 8000 ~ 9,
        ISCO == 8100 ~ 9,
        ISCO == 8130 ~ 9,
        ISCO == 8140 ~ 9,
        ISCO == 8200 ~ 9,
        ISCO == 8220 ~ 9,
        ISCO == 8230 ~ 9,
        ISCO == 8250 ~ 9,
        ISCO == 8260 ~ 9,
        ISCO == 8270 ~ 9,
        ISCO == 8280 ~ 9,
        ISCO == 8300 ~ 9,
        ISCO == 8310 ~ 9,
        ISCO == 8320 ~ 9,
        ISCO == 8330 ~ 9,
        ISCO == 8400 ~ 9,
        ISCO == 9000 ~ 9,
        ISCO == 9130 ~ 9,
        ISCO == 9140 ~ 9,
        ISCO == 9150 ~ 9,
        ISCO == 9160 ~ 9,
        ISCO == 9300 ~ 9,
        ISCO == 9310 ~ 9,
        ISCO == 9320 ~ 9,
        ISCO == 9330 ~ 9,
        ISCO == 1311 ~ 9,
        ISCO == 7424 ~ 9,
        ISCO == 7132 ~ 9,
        ISCO == 7321 ~ 9,
        ISCO == 8276 ~ 9,
        ISCO == 8112 ~ 9,
        ISCO == 7124 ~ 9,
        ISCO == 7122 ~ 9,
        ISCO == 8141 ~ 9,
        ISCO == 8340 ~ 9,
        ISCO == 7129 ~ 8,
        ISCO == 7123 ~ 9,
        ISCO == 8277 ~ 9,
        ISCO == 8332 ~ 9,
        ISCO == 7416 ~ 9,
        ISCO == 7432 ~ 9,
        ISCO == 8212 ~ 9,
        ISCO == 8278 ~ 9,
        ISCO == 8111 ~ 9,
        ISCO == 8271 ~ 9,
        ISCO == 7136 ~ 9,
        ISCO == 7113 ~ 9,
        ISCO == 5122 ~ 9,
        ISCO == 7141 ~ 9,
        ISCO == 7423 ~ 9,
        ISCO == 7214 ~ 9,
        ISCO == 8324 ~ 9,
        ISCO == 7441 ~ 9,
        ISCO == 7133 ~ 9,
        ISCO == 7411 ~ 9,
        ISCO == 7436 ~ 9,
        ISCO == 7422 ~ 9,
        ISCO == 8142 ~ 9,
        ISCO == 7431 ~ 9,
        ISCO == 8162 ~ 9,
        ISCO == 7412 ~ 9,
        ISCO == 8139 ~ 9,
        ISCO == 7435 ~ 9,
        ISCO == 7442 ~ 9,
        ISCO == 8262 ~ 9,
        ISCO == 8153 ~ 9,
        ISCO == 7231 ~ 9,
        ISCO == 8272 ~ 9,
        ISCO == 7213 ~ 9,
        ISCO == 8121 ~ 9,
        ISCO == 7134 ~ 9,
        ISCO == 8231 ~ 9,
        ISCO == 8333 ~ 9,
        ISCO == 8222 ~ 9,
        ISCO == 7135 ~ 9,
        ISCO == 8266 ~ 9,
        ISCO == 8223 ~ 9,
        ISCO == 8124 ~ 9,
        ISCO == 8322 ~ 9,
        ISCO == 7212 ~ 9,
        ISCO == 7421 ~ 9,
        ISCO == 7224 ~ 9,
        ISCO == 7137 ~ 9,
        ISCO == 8261 ~ 9,
        ISCO == 8122 ~ 9,
        ISCO == 8163 ~ 9,
        ISCO == 7211 ~ 9,
        ISCO == 7221 ~ 9,
        ISCO == 7345 ~ 9,
        ISCO == 8269 ~ 9,
        ISCO == 8152 ~ 9,
        ISCO == 7215 ~ 9,
        ISCO == 5141 ~ 9,
        ISCO == 8232 ~ 9,
        ISCO == 7322 ~ 9,
        ISCO == 8281 ~ 9,
        ISCO == 8264 ~ 9,
        ISCO == 7324 ~ 9,
        ISCO == 7131 ~ 9,
        ISCO == 8143 ~ 9,
        ISCO == 7341 ~ 9,
        ISCO == 8312 ~ 9,
        ISCO == 8113 ~ 9,
        ISCO == 8161 ~ 9,
        ISCO == 8253 ~ 9,
        ISCO == 5163 ~ 9,
        ISCO == 8251 ~ 9,
        ISCO == 7332 ~ 9,
        ISCO == 8240 ~ 9,
        ISCO == 7223 ~ 9,
        ISCO == 7433 ~ 9,
        ISCO == 8252 ~ 9,
        ISCO == 8283 ~ 9,
        ISCO == 5169 ~ 9,
        ISCO == 7415 ~ 9,
        ISCO == 7244 ~ 9,
        ISCO == 8221 ~ 9,
        ISCO == 8290 ~ 9,
        ISCO == 8155 ~ 8,
        ISCO == 8172 ~ 9,
        ISCO == 8154 ~ 8,
        ISCO == 7112 ~ 9,
        ISCO == 7121 ~ 9,
        ISCO == 7142 ~ 9,
        ISCO == 7143 ~ 9,
        ISCO == 7323 ~ 9,
        ISCO == 7331 ~ 9,
        ISCO == 7342 ~ 9,
        ISCO == 7346 ~ 9,
        ISCO == 7413 ~ 9,
        ISCO == 7414 ~ 9,
        ISCO == 7434 ~ 9,
        ISCO == 7437 ~ 9,
        ISCO == 8123 ~ 9,
        ISCO == 8131 ~ 9,
        ISCO == 8171 ~ 9,
        ISCO == 8211 ~ 9,
        ISCO == 8224 ~ 9,
        ISCO == 8229 ~ 9,
        ISCO == 8263 ~ 9,
        ISCO == 8265 ~ 9,
        ISCO == 8274 ~ 9,
        ISCO == 8275 ~ 9,
        ISCO == 8279 ~ 9,
        ISCO == 8282 ~ 9,
        ISCO == 8284 ~ 9,
        ISCO == 8285 ~ 9,
        ISCO == 8286 ~ 9,
        ISCO == 8321 ~ 9,
        ISCO == 8323 ~ 9,
        ISCO == 8334 ~ 9,
        ISCO == 9153 ~ 9,
        ISCO == 9313 ~ 9,
        ISCO == 8273 ~ 10,
        ISCO == 9120 ~ 10,
        ISCO == 9162 ~ 10,
        ISCO == 9311 ~ 10,
        ISCO == 9312 ~ 10,
        ISCO == 9321 ~ 10,
        ISCO == 5121 ~ 10,
        ISCO == 5131 ~ 10,
        ISCO == 5133 ~ 10,
        ISCO == 5230 ~ 10,
        ISCO == 9111 ~ 10,
        ISCO == 9112 ~ 10,
        ISCO == 9131 ~ 10,
        ISCO == 9132 ~ 10,
        ISCO == 9133 ~ 10,
        ISCO == 9141 ~ 10,
        ISCO == 9142 ~ 10,
        ISCO == 9161 ~ 10,
        ISCO == 9322 ~ 10,
        ISCO == 9331 ~ 10,
        ISCO == 9332 ~ 10,
        ISCO == 9333 ~ 10,
        ISCO == 7111 ~ 10,
        ISCO == 6000 ~ 10,
        ISCO == 6100 ~ 10,
        ISCO == 6110 ~ 10,
        ISCO == 6120 ~ 10,
        ISCO == 6134 ~ 10,
        ISCO == 6140 ~ 10,
        ISCO == 6150 ~ 10,
        ISCO == 9200 ~ 10,
        ISCO == 9210 ~ 10,
        ISCO == 6111 ~ 11,
        ISCO == 6112 ~ 11,
        ISCO == 6113 ~ 11,
        ISCO == 6114 ~ 11,
        ISCO == 6121 ~ 11,
        ISCO == 6122 ~ 11,
        ISCO == 6123 ~ 11,
        ISCO == 6124 ~ 11,
        ISCO == 6129 ~ 11,
        ISCO == 6130 ~ 11,
        ISCO == 6141 ~ 11,
        ISCO == 6142 ~ 11,
        ISCO == 6151 ~ 11,
        ISCO == 6152 ~ 11,
        ISCO == 6153 ~ 11,
        ISCO == 6154 ~ 11,
        ISCO == 6210 ~ 11,
        ISCO == 8331 ~ 11,
        ISCO == 9211 ~ 11,
        ISCO == 9212 ~ 11,
        ISCO == 9213 ~ 11,
        ISCO == 6131 ~ 11,
        ISCO == 6132 ~ 11,
        ISCO == 6133 ~ 11,
        ISCO == 6200 ~ 11,
        TRUE ~ EGP11),
      EGP11 = case_when(
        PosicaoOcupacao == 2 & ISIC != 10 & ISIC != 100 ~ 5, #empregadores nao rurais
        PosicaoOcupacao == 2 & ISIC == 10 & EGP11 %in% c(1:4,8:10) ~ 6, # empregadores rurais
        PosicaoOcupacao == 2 & EGP11 %in% c(11) ~ 6, # empregadores rurais
        EGP11 == 11 & PosicaoOcupacao %in% c(0,3) ~ 7, # empregadores rurais
        TRUE ~ EGP11)
    ) |>
    select(-c(var_trabalhando, any_of(var_afastado), var_aprendiz, var_trabalho_consumo,
              var_buscou_emprego, var_posicao_ocupacao,var_codigo_ocupacao,any_of(var_cnae_censo)))

  censo <- dados |>
    left_join(censo_processing,
              by = c("id_dom","id_pes"),
              keep = FALSE)

  # Lista que será retornada do processo
  results <- censo

  return(results)
}
